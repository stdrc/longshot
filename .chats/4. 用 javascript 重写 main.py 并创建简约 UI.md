# ç”¨ javascript é‡å†™ main.py å¹¶åˆ›å»ºç®€çº¦ UI
_Exported on 2025/8/17 at GMT+8 17:23:11 from Cursor (1.4.5)_

---

**User**

æŠŠ main.py ç”¨ javascript é‡å†™ï¼Œæ”¾åœ¨ web æ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª index.html æ¥ä½¿ç”¨è¿™ä¸ª js ç‰ˆæœ¬ï¼Œåœ¨æµè§ˆå™¨çº¯å‰ç«¯æä¾›æ‹¼æ¥é•¿æˆªå›¾çš„åŠŸèƒ½ã€‚UI è¦éå¸¸ç®€çº¦ã€‚

---

**Cursor**

æˆ‘æ¥å¸®ä½ æŠŠ `main.py` é‡å†™ä¸º JavaScript ç‰ˆæœ¬ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªç®€çº¦çš„å‰ç«¯ç•Œé¢ã€‚é¦–å…ˆè®©æˆ‘è¯»å–åŸå§‹çš„ Python æ–‡ä»¶æ¥äº†è§£åŠŸèƒ½ã€‚

ç°åœ¨æˆ‘äº†è§£äº†åŸå§‹ Python ä»£ç çš„åŠŸèƒ½ã€‚è¿™æ˜¯ä¸€ä¸ªé•¿æˆªå›¾æ‹¼æ¥å·¥å…·ï¼Œä½¿ç”¨æœ€é•¿å…¬å…±å­ä¸²ç®—æ³•æ¥æ‰¾åˆ°å›¾ç‰‡é‡å éƒ¨åˆ†å¹¶è¿›è¡Œæ‹¼æ¥ã€‚è®©æˆ‘åˆ›å»ºä»»åŠ¡è®¡åˆ’å¹¶å¼€å§‹å®ç°ï¼š

ç°åœ¨å¼€å§‹åˆ›å»º JavaScript ç‰ˆæœ¬çš„é•¿æˆªå›¾æ‹¼æ¥åŠŸèƒ½ï¼š

```javascript
/**
 * é•¿æˆªå›¾æ‹¼æ¥å·¥å…· - JavaScript ç‰ˆæœ¬
 * ä½¿ç”¨æœ€é•¿å…¬å…±å­ä¸²ç®—æ³•æ‰¾åˆ°å›¾ç‰‡é‡å éƒ¨åˆ†å¹¶è¿›è¡Œæ‹¼æ¥
 */

class LongScreenshotStitcher {
    constructor() {
        this.ignoreRightPixels = 20; // å¿½ç•¥å³ä¾§åƒç´ æ•°é‡ï¼Œç”¨äºæ’é™¤æ»šåŠ¨æ¡å½±å“
    }

    /**
     * å°†å›¾ç‰‡çš„æ¯ä¸€è¡Œè½¬æ¢ä¸ºå“ˆå¸Œå€¼ï¼Œç”¨äºå¿«é€Ÿæ¯”è¾ƒ
     * @param {ImageData} imageData - Canvas ImageData å¯¹è±¡
     * @param {number} ignoreRightPixels - å¿½ç•¥å³ä¾§å¤šå°‘åƒç´ 
     * @returns {Array<number>} è¡Œå“ˆå¸Œæ•°ç»„
     */
    imageToRowHashes(imageData, ignoreRightPixels = 20) {
        const { width, height, data } = imageData;
        const rowHashes = [];

        for (let y = 0; y < height; y++) {
            const rowStart = y * width * 4;
            const effectiveWidth = Math.max(0, width - ignoreRightPixels);
            
            // è®¡ç®—è¡Œçš„å¹³å‡è‰²å½©å€¼
            let sumR = 0, sumG = 0, sumB = 0;
            let pixelCount = 0;

            for (let x = 0; x < effectiveWidth; x++) {
                const pixelIndex = rowStart + x * 4;
                sumR += data[pixelIndex];     // R
                sumG += data[pixelIndex + 1]; // G
                sumB += data[pixelIndex + 2]; // B
                pixelCount++;
            }

            if (pixelCount > 0) {
                // è®¡ç®—å¹³å‡å€¼å¹¶é‡åŒ–ä»¥æé«˜å®¹å¿åº¦
                const avgR = Math.floor((sumR / pixelCount) / 8) * 8;
                const avgG = Math.floor((sumG / pixelCount) / 8) * 8;
                const avgB = Math.floor((sumB / pixelCount) / 8) * 8;
                
                // ç®€å•çš„å“ˆå¸Œå‡½æ•°
                const hash = avgR * 65536 + avgG * 256 + avgB;
                rowHashes.push(hash);
            } else {
                rowHashes.push(0);
            }
        }

        return rowHashes;
    }

    /**
     * æ‰¾åˆ°ä¸¤ä¸ªåºåˆ—çš„æœ€é•¿å…¬å…±å­ä¸²
     * @param {Array<number>} seq1 - ç¬¬ä¸€ä¸ªåºåˆ—
     * @param {Array<number>} seq2 - ç¬¬äºŒä¸ªåºåˆ—
     * @param {number} minRatio - æœ€å°é‡å æ¯”ä¾‹é˜ˆå€¼
     * @returns {Object} {seq1Start, seq2Start, length}
     */
    findLongestCommonSubstring(seq1, seq2, minRatio = 0.01) {
        const m = seq1.length;
        const n = seq2.length;
        const minLength = Math.floor(Math.min(m, n) * minRatio);

        // åŠ¨æ€è§„åˆ’è¡¨
        const dp = Array(m + 1).fill(0).map(() => Array(n + 1).fill(0));

        let maxLength = 0;
        let endingPosI = 0;
        let endingPosJ = 0;

        for (let i = 1; i <= m; i++) {
            for (let j = 1; j <= n; j++) {
                if (seq1[i - 1] === seq2[j - 1]) {
                    dp[i][j] = dp[i - 1][j - 1] + 1;
                    if (dp[i][j] > maxLength) {
                        maxLength = dp[i][j];
                        endingPosI = i;
                        endingPosJ = j;
                    }
                } else {
                    dp[i][j] = 0;
                }
            }
        }

        if (maxLength < minLength) {
            return { seq1Start: -1, seq2Start: -1, length: 0 };
        }

        const seq1Start = endingPosI - maxLength;
        const seq2Start = endingPosJ - maxLength;

        return { seq1Start, seq2Start, length: maxLength };
    }

    /**
     * å¯»æ‰¾æœ€ä½³é‡å åŒºåŸŸ
     * @param {Array<number>} img1Hashes - ç¬¬ä¸€å¼ å›¾ç‰‡çš„è¡Œå“ˆå¸Œ
     * @param {Array<number>} img2Hashes - ç¬¬äºŒå¼ å›¾ç‰‡çš„è¡Œå“ˆå¸Œ
     * @returns {Object} é‡å ä¿¡æ¯
     */
    findBestOverlap(img1Hashes, img2Hashes) {
        console.log(`æœç´¢é‡å åŒºåŸŸ: img1æœ‰${img1Hashes.length}è¡Œ, img2æœ‰${img2Hashes.length}è¡Œ`);

        const overlap = this.findLongestCommonSubstring(img1Hashes, img2Hashes, 0.01);

        if (overlap.length > 0) {
            const overlapRatio = overlap.length / Math.min(img1Hashes.length, img2Hashes.length);
            console.log(`æ‰¾åˆ°é‡å : é•¿åº¦${overlap.length}è¡Œ, å æ¯”${(overlapRatio * 100).toFixed(2)}%`);
            return overlap;
        } else {
            console.log("æœªæ‰¾åˆ°ä»»ä½•é‡å åŒºåŸŸ");
            return { seq1Start: -1, seq2Start: -1, length: 0 };
        }
    }

    /**
     * å°†å›¾ç‰‡ç»˜åˆ¶åˆ° Canvas å¹¶è·å– ImageData
     * @param {HTMLImageElement} img - å›¾ç‰‡å…ƒç´ 
     * @returns {Object} {canvas, ctx, imageData}
     */
    imageToImageData(img) {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        
        canvas.width = img.width;
        canvas.height = img.height;
        
        ctx.drawImage(img, 0, 0);
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        
        return { canvas, ctx, imageData };
    }

    /**
     * æ‹¼æ¥ä¸¤å¼ å›¾ç‰‡
     * @param {HTMLImageElement} img1 - ç¬¬ä¸€å¼ å›¾ç‰‡
     * @param {HTMLImageElement} img2 - ç¬¬äºŒå¼ å›¾ç‰‡
     * @returns {Promise<HTMLCanvasElement>} æ‹¼æ¥ç»“æœçš„ Canvas
     */
    async stitchImages(img1, img2) {
        console.log(`å¤„ç†å›¾ç‰‡: ${img1.width}x${img1.height} + ${img2.width}x${img2.height}`);

        // ç¡®ä¿ä¸¤å¼ å›¾ç‰‡å®½åº¦ç›¸åŒ
        let processedImg1 = img1;
        if (img1.width !== img2.width) {
            console.log(`è°ƒæ•´å›¾ç‰‡å®½åº¦: ${img1.width} -> ${img2.width}`);
            processedImg1 = await this.resizeImage(img1, img2.width, Math.floor(img1.height * img2.width / img1.width));
        }

        // è·å–å›¾ç‰‡æ•°æ®
        const img1Data = this.imageToImageData(processedImg1);
        const img2Data = this.imageToImageData(img2);

        console.log(`å¿½ç•¥å³ä¾§ ${this.ignoreRightPixels} åƒç´ æ¥æ’é™¤æ»šåŠ¨æ¡å½±å“`);
        
        // è½¬æ¢ä¸ºè¡Œå“ˆå¸Œ
        const img1Hashes = this.imageToRowHashes(img1Data.imageData, this.ignoreRightPixels);
        const img2Hashes = this.imageToRowHashes(img2Data.imageData, this.ignoreRightPixels);

        // å¯»æ‰¾é‡å åŒºåŸŸ
        const overlap = this.findBestOverlap(img1Hashes, img2Hashes);

        // åˆ›å»ºç»“æœ Canvas
        const resultCanvas = document.createElement('canvas');
        const resultCtx = resultCanvas.getContext('2d');

        if (overlap.length === 0) {
            console.log("æœªæ‰¾åˆ°é‡å åŒºåŸŸï¼Œç›´æ¥æ‹¼æ¥");
            // ç›´æ¥æ‹¼æ¥
            resultCanvas.width = img2.width;
            resultCanvas.height = processedImg1.height + img2.height;
            
            resultCtx.drawImage(processedImg1, 0, 0);
            resultCtx.drawImage(img2, 0, processedImg1.height);
        } else {
            const { seq1Start: img1Start, seq2Start: img2Start, length: overlapLength } = overlap;
            console.log(`æ‰¾åˆ°é‡å åŒºåŸŸ: img1[${img1Start}:${img1Start + overlapLength}] = img2[${img2Start}:${img2Start + overlapLength}]`);

            // è®¡ç®—æ‹¼æ¥åçš„æ€»é«˜åº¦
            const img1KeepHeight = img1Start + overlapLength;
            const img2SkipHeight = img2Start + overlapLength;
            const img2KeepHeight = img2.height - img2SkipHeight;
            const resultHeight = img1KeepHeight + img2KeepHeight;

            console.log(`æ‹¼æ¥è®¡ç®—: img1ä¿ç•™${img1KeepHeight}è¡Œ + img2è·³è¿‡${img2SkipHeight}è¡Œä¿ç•™${img2KeepHeight}è¡Œ = æ€»è®¡${resultHeight}è¡Œ`);

            resultCanvas.width = img2.width;
            resultCanvas.height = resultHeight;

            // ç»˜åˆ¶img1çš„ä¿ç•™éƒ¨åˆ†
            resultCtx.drawImage(
                processedImg1,
                0, 0, processedImg1.width, img1KeepHeight,
                0, 0, processedImg1.width, img1KeepHeight
            );

            // ç»˜åˆ¶img2çš„å‰©ä½™éƒ¨åˆ†
            if (img2KeepHeight > 0) {
                resultCtx.drawImage(
                    img2,
                    0, img2SkipHeight, img2.width, img2KeepHeight,
                    0, img1KeepHeight, img2.width, img2KeepHeight
                );
            }
        }

        return resultCanvas;
    }

    /**
     * è°ƒæ•´å›¾ç‰‡å°ºå¯¸
     * @param {HTMLImageElement} img - åŸå›¾ç‰‡
     * @param {number} newWidth - æ–°å®½åº¦
     * @param {number} newHeight - æ–°é«˜åº¦
     * @returns {Promise<HTMLImageElement>} è°ƒæ•´åçš„å›¾ç‰‡
     */
    async resizeImage(img, newWidth, newHeight) {
        return new Promise((resolve) => {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = newWidth;
            canvas.height = newHeight;
            
            ctx.drawImage(img, 0, 0, newWidth, newHeight);
            
            const resizedImg = new Image();
            resizedImg.onload = () => resolve(resizedImg);
            resizedImg.src = canvas.toDataURL();
        });
    }

    /**
     * æ‹¼æ¥å¤šå¼ å›¾ç‰‡
     * @param {Array<File>} imageFiles - å›¾ç‰‡æ–‡ä»¶æ•°ç»„
     * @param {Function} progressCallback - è¿›åº¦å›è°ƒå‡½æ•°
     * @returns {Promise<HTMLCanvasElement>} æ‹¼æ¥ç»“æœçš„ Canvas
     */
    async stitchMultipleImages(imageFiles, progressCallback = null) {
        if (imageFiles.length < 2) {
            throw new Error("è‡³å°‘éœ€è¦ä¸¤å¼ å›¾ç‰‡è¿›è¡Œæ‹¼æ¥");
        }

        console.log(`å¼€å§‹æ‹¼æ¥ ${imageFiles.length} å¼ å›¾ç‰‡...`);

        // åŠ è½½æ‰€æœ‰å›¾ç‰‡
        const images = [];
        for (let i = 0; i < imageFiles.length; i++) {
            const img = await this.loadImage(imageFiles[i]);
            images.push(img);
            if (progressCallback) {
                progressCallback({
                    stage: 'loading',
                    current: i + 1,
                    total: imageFiles.length
                });
            }
        }

        // é€ä¸ªæ‹¼æ¥
        let result = images[0];
        console.log(`åŸºç¡€å›¾ç‰‡: ${result.width}x${result.height}`);

        for (let i = 1; i < images.length; i++) {
            console.log(`\næ‹¼æ¥ç¬¬ ${i + 1} å¼ å›¾ç‰‡`);
            
            // å¦‚æœ result æ˜¯ Canvasï¼Œéœ€è¦è½¬æ¢ä¸º Image
            if (result instanceof HTMLCanvasElement) {
                const tempImg = new Image();
                tempImg.src = result.toDataURL();
                await new Promise(resolve => {
                    tempImg.onload = resolve;
                });
                result = tempImg;
            }

            result = await this.stitchImages(result, images[i]);
            console.log(`å½“å‰ç»“æœå°ºå¯¸: ${result.width}x${result.height}`);

            if (progressCallback) {
                progressCallback({
                    stage: 'stitching',
                    current: i,
                    total: images.length - 1
                });
            }
        }

        console.log(`æ‹¼æ¥å®Œæˆ! æœ€ç»ˆå°ºå¯¸: ${result.width}x${result.height}`);
        return result;
    }

    /**
     * ä»æ–‡ä»¶åŠ è½½å›¾ç‰‡
     * @param {File} file - å›¾ç‰‡æ–‡ä»¶
     * @returns {Promise<HTMLImageElement>} åŠ è½½çš„å›¾ç‰‡
     */
    loadImage(file) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            const url = URL.createObjectURL(file);
            
            img.onload = () => {
                URL.revokeObjectURL(url);
                resolve(img);
            };
            
            img.onerror = () => {
                URL.revokeObjectURL(url);
                reject(new Error(`æ— æ³•åŠ è½½å›¾ç‰‡: ${file.name}`));
            };
            
            img.src = url;
        });
    }

    /**
     * è®¾ç½®å¿½ç•¥å³ä¾§åƒç´ æ•°é‡
     * @param {number} pixels - åƒç´ æ•°é‡
     */
    setIgnoreRightPixels(pixels) {
        this.ignoreRightPixels = Math.max(0, pixels);
    }
}

// å¯¼å‡ºç±»ä¾›å…¶ä»–è„šæœ¬ä½¿ç”¨
if (typeof module !== 'undefined' && module.exports) {
    module.exports = LongScreenshotStitcher;
}
```

ç°åœ¨åˆ›å»ºç®€çº¦çš„ HTML ç•Œé¢ï¼š

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 300;
            color: #34495e;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 12px;
            padding: 60px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }

        .upload-area.dragover {
            border-color: #2980b9;
            background: #e8f4fd;
        }

        .upload-icon {
            font-size: 3em;
            color: #bdc3c7;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 10px;
        }

        .upload-hint {
            font-size: 0.9em;
            color: #95a5a6;
        }

        .file-input {
            display: none;
        }

        .settings {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .settings h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .setting-item label {
            color: #34495e;
            font-weight: 500;
        }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .file-list h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
        }

        .file-item:last-child {
            border-bottom: none;
        }

        .file-info {
            display: flex;
            align-items: center;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

        .file-details {
            display: flex;
            flex-direction: column;
        }

        .file-name {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 2px;
        }

        .file-size {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s ease;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .progress {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .result {
            background: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .empty-state {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 20px 0;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .upload-area {
                padding: 40px 15px;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
            <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
        </div>

        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">ğŸ“</div>
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>

        <div class="settings">
            <h3>è®¾ç½®</h3>
            <div class="setting-item">
                <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
                <input type="number" id="ignorePixels" value="20" min="0" max="100">
            </div>
        </div>

        <div class="file-list" id="fileList">
            <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
            <div id="fileItems">
                <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-primary" id="stitchBtn" disabled>
                ğŸ”— å¼€å§‹æ‹¼æ¥
            </button>
            <button class="btn btn-secondary" id="clearBtn" disabled>
                ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
            </button>
        </div>

        <div class="progress" id="progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
        </div>

        <div class="result" id="result">
            <h3>æ‹¼æ¥ç»“æœ</h3>
            <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ">
            <div>
                <button class="btn btn-primary" id="downloadBtn">
                    ğŸ’¾ ä¸‹è½½å›¾ç‰‡
                </button>
            </div>
        </div>
    </div>

    <script src="longshot.js"></script>
    <script>
        class LongShotApp {
            constructor() {
                this.stitcher = new LongScreenshotStitcher();
                this.selectedFiles = [];
                this.resultCanvas = null;
                
                this.initializeElements();
                this.bindEvents();
            }

            initializeElements() {
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.fileList = document.getElementById('fileList');
                this.fileItems = document.getElementById('fileItems');
                this.fileCount = document.getElementById('fileCount');
                this.stitchBtn = document.getElementById('stitchBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.progress = document.getElementById('progress');
                this.progressFill = document.getElementById('progressFill');
                this.progressText = document.getElementById('progressText');
                this.result = document.getElementById('result');
                this.resultImage = document.getElementById('resultImage');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.ignorePixels = document.getElementById('ignorePixels');
            }

            bindEvents() {
                // æ–‡ä»¶é€‰æ‹©
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

                // æ‹–æ‹½ä¸Šä¼ 
                this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
                this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
                this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

                // æŒ‰é’®äº‹ä»¶
                this.stitchBtn.addEventListener('click', () => this.startStitching());
                this.clearBtn.addEventListener('click', () => this.clearFiles());
                this.downloadBtn.addEventListener('click', () => this.downloadResult());

                // è®¾ç½®å˜æ›´
                this.ignorePixels.addEventListener('change', () => {
                    this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
                });
            }

            handleFileSelect(e) {
                const files = Array.from(e.target.files);
                this.addFiles(files);
            }

            handleDragOver(e) {
                e.preventDefault();
                this.uploadArea.classList.add('dragover');
            }

            handleDragLeave(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
            }

            handleDrop(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
                
                const files = Array.from(e.dataTransfer.files).filter(file => 
                    file.type.startsWith('image/')
                );
                this.addFiles(files);
            }

            addFiles(files) {
                const validFiles = files.filter(file => file.type.startsWith('image/'));
                this.selectedFiles.push(...validFiles);
                this.updateFileList();
                this.updateButtons();
            }

            updateFileList() {
                this.fileCount.textContent = this.selectedFiles.length;
                
                if (this.selectedFiles.length === 0) {
                    this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
                    return;
                }

                this.fileItems.innerHTML = '';
                this.selectedFiles.forEach((file, index) => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;
                    
                    this.fileItems.appendChild(fileItem);
                });
            }

            removeFile(index) {
                this.selectedFiles.splice(index, 1);
                this.updateFileList();
                this.updateButtons();
            }

            clearFiles() {
                this.selectedFiles = [];
                this.fileInput.value = '';
                this.updateFileList();
                this.updateButtons();
                this.hideResult();
            }

            updateButtons() {
                const hasEnoughFiles = this.selectedFiles.length >= 2;
                this.stitchBtn.disabled = !hasEnoughFiles;
                this.clearBtn.disabled = this.selectedFiles.length === 0;
            }

            async startStitching() {
                if (this.selectedFiles.length < 2) {
                    alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
                    return;
                }

                this.showProgress();
                this.hideResult();
                this.stitchBtn.disabled = true;

                try {
                    this.resultCanvas = await this.stitcher.stitchMultipleImages(
                        this.selectedFiles,
                        (progress) => this.updateProgress(progress)
                    );

                    this.showResult();
                } catch (error) {
                    console.error('æ‹¼æ¥å¤±è´¥:', error);
                    alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
                } finally {
                    this.hideProgress();
                    this.stitchBtn.disabled = false;
                }
            }

            updateProgress(progress) {
                let percentage, text;
                
                if (progress.stage === 'loading') {
                    percentage = (progress.current / progress.total) * 50;
                    text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
                } else if (progress.stage === 'stitching') {
                    percentage = 50 + (progress.current / progress.total) * 50;
                    text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
                }
                
                this.progressFill.style.width = `${percentage}%`;
                this.progressText.textContent = text;
            }

            showProgress() {
                this.progress.style.display = 'block';
                this.progressFill.style.width = '0%';
                this.progressText.textContent = 'å‡†å¤‡ä¸­...';
            }

            hideProgress() {
                this.progress.style.display = 'none';
            }

            showResult() {
                if (this.resultCanvas) {
                    this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                    this.result.style.display = 'block';
                    
                    // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                    this.result.scrollIntoView({ behavior: 'smooth' });
                }
            }

            hideResult() {
                this.result.style.display = 'none';
            }

            downloadResult() {
                if (!this.resultCanvas) return;

                const link = document.createElement('a');
                link.download = `longshot-result-${new Date().getTime()}.jpg`;
                link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                link.click();
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        const app = new LongShotApp();
    </script>
</body>
</html>
```

ç°åœ¨æ›´æ–°ä»»åŠ¡çŠ¶æ€å¹¶æ£€æŸ¥æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ï¼š

å¤ªå¥½äº†ï¼æ²¡æœ‰è¯­æ³•é”™è¯¯ã€‚ç°åœ¨è®©æˆ‘ä¼˜åŒ–æ€§èƒ½ï¼Œè¿™æ˜¯æœ€åä¸€ä¸ªä»»åŠ¡ï¼š

```javascript
/**
 * é•¿æˆªå›¾æ‹¼æ¥å·¥å…· - JavaScript ç‰ˆæœ¬
 * ä½¿ç”¨æœ€é•¿å…¬å…±å­ä¸²ç®—æ³•æ‰¾åˆ°å›¾ç‰‡é‡å éƒ¨åˆ†å¹¶è¿›è¡Œæ‹¼æ¥
 */

class LongScreenshotStitcher {
    constructor() {
        this.ignoreRightPixels = 20; // å¿½ç•¥å³ä¾§åƒç´ æ•°é‡ï¼Œç”¨äºæ’é™¤æ»šåŠ¨æ¡å½±å“
    }

    /**
     * å°†å›¾ç‰‡çš„æ¯ä¸€è¡Œè½¬æ¢ä¸ºå“ˆå¸Œå€¼ï¼Œç”¨äºå¿«é€Ÿæ¯”è¾ƒ
     * @param {ImageData} imageData - Canvas ImageData å¯¹è±¡
     * @param {number} ignoreRightPixels - å¿½ç•¥å³ä¾§å¤šå°‘åƒç´ 
     * @returns {Array<number>} è¡Œå“ˆå¸Œæ•°ç»„
     */
    imageToRowHashes(imageData, ignoreRightPixels = 20) {
        const { width, height, data } = imageData;
        const rowHashes = [];
        const effectiveWidth = Math.max(0, width - ignoreRightPixels);

        // æ‰¹é‡å¤„ç†ä»¥æé«˜æ€§èƒ½
        for (let y = 0; y < height; y++) {
            const rowStart = y * width * 4;
            
            // ä½¿ç”¨æ›´é«˜æ•ˆçš„é‡‡æ ·ç­–ç•¥ - æ¯éš”å‡ ä¸ªåƒç´ é‡‡æ ·ä¸€æ¬¡
            const sampleStep = Math.max(1, Math.floor(effectiveWidth / 100)); // æœ€å¤šé‡‡æ ·100ä¸ªç‚¹
            let sumR = 0, sumG = 0, sumB = 0;
            let sampleCount = 0;

            for (let x = 0; x < effectiveWidth; x += sampleStep) {
                const pixelIndex = rowStart + x * 4;
                sumR += data[pixelIndex];     // R
                sumG += data[pixelIndex + 1]; // G
                sumB += data[pixelIndex + 2]; // B
                sampleCount++;
            }

            if (sampleCount > 0) {
                // è®¡ç®—å¹³å‡å€¼å¹¶é‡åŒ–ä»¥æé«˜å®¹å¿åº¦
                const avgR = Math.floor((sumR / sampleCount) / 16) * 16; // å¢å¤§é‡åŒ–æ­¥é•¿
                const avgG = Math.floor((sumG / sampleCount) / 16) * 16;
                const avgB = Math.floor((sumB / sampleCount) / 16) * 16;
                
                // æ›´é«˜æ•ˆçš„å“ˆå¸Œå‡½æ•°
                const hash = (avgR << 16) | (avgG << 8) | avgB;
                rowHashes.push(hash);
            } else {
                rowHashes.push(0);
            }
        }

        return rowHashes;
    }

    /**
     * æ‰¾åˆ°ä¸¤ä¸ªåºåˆ—çš„æœ€é•¿å…¬å…±å­ä¸²
     * @param {Array<number>} seq1 - ç¬¬ä¸€ä¸ªåºåˆ—
     * @param {Array<number>} seq2 - ç¬¬äºŒä¸ªåºåˆ—
     * @param {number} minRatio - æœ€å°é‡å æ¯”ä¾‹é˜ˆå€¼
     * @returns {Object} {seq1Start, seq2Start, length}
     */
    findLongestCommonSubstring(seq1, seq2, minRatio = 0.01) {
        const m = seq1.length;
        const n = seq2.length;
        const minLength = Math.floor(Math.min(m, n) * minRatio);

        // åŠ¨æ€è§„åˆ’è¡¨
        const dp = Array(m + 1).fill(0).map(() => Array(n + 1).fill(0));

        let maxLength = 0;
        let endingPosI = 0;
        let endingPosJ = 0;

        for (let i = 1; i <= m; i++) {
            for (let j = 1; j <= n; j++) {
                if (seq1[i - 1] === seq2[j - 1]) {
                    dp[i][j] = dp[i - 1][j - 1] + 1;
                    if (dp[i][j] > maxLength) {
                        maxLength = dp[i][j];
                        endingPosI = i;
                        endingPosJ = j;
                    }
                } else {
                    dp[i][j] = 0;
                }
            }
        }

        if (maxLength < minLength) {
            return { seq1Start: -1, seq2Start: -1, length: 0 };
        }

        const seq1Start = endingPosI - maxLength;
        const seq2Start = endingPosJ - maxLength;

        return { seq1Start, seq2Start, length: maxLength };
    }

    /**
     * å¯»æ‰¾æœ€ä½³é‡å åŒºåŸŸ
     * @param {Array<number>} img1Hashes - ç¬¬ä¸€å¼ å›¾ç‰‡çš„è¡Œå“ˆå¸Œ
     * @param {Array<number>} img2Hashes - ç¬¬äºŒå¼ å›¾ç‰‡çš„è¡Œå“ˆå¸Œ
     * @returns {Object} é‡å ä¿¡æ¯
     */
    findBestOverlap(img1Hashes, img2Hashes) {
        console.log(`æœç´¢é‡å åŒºåŸŸ: img1æœ‰${img1Hashes.length}è¡Œ, img2æœ‰${img2Hashes.length}è¡Œ`);

        const overlap = this.findLongestCommonSubstring(img1Hashes, img2Hashes, 0.01);

        if (overlap.length > 0) {
            const overlapRatio = overlap.length / Math.min(img1Hashes.length, img2Hashes.length);
            console.log(`æ‰¾åˆ°é‡å : é•¿åº¦${overlap.length}è¡Œ, å æ¯”${(overlapRatio * 100).toFixed(2)}%`);
            return overlap;
        } else {
            console.log("æœªæ‰¾åˆ°ä»»ä½•é‡å åŒºåŸŸ");
            return { seq1Start: -1, seq2Start: -1, length: 0 };
        }
    }

    /**
     * å°†å›¾ç‰‡ç»˜åˆ¶åˆ° Canvas å¹¶è·å– ImageData
     * @param {HTMLImageElement} img - å›¾ç‰‡å…ƒç´ 
     * @returns {Object} {canvas, ctx, imageData}
     */
    imageToImageData(img) {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        
        canvas.width = img.width;
        canvas.height = img.height;
        
        ctx.drawImage(img, 0, 0);
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        
        return { canvas, ctx, imageData };
    }

    /**
     * æ‹¼æ¥ä¸¤å¼ å›¾ç‰‡
     * @param {HTMLImageElement} img1 - ç¬¬ä¸€å¼ å›¾ç‰‡
     * @param {HTMLImageElement} img2 - ç¬¬äºŒå¼ å›¾ç‰‡
     * @returns {Promise<HTMLCanvasElement>} æ‹¼æ¥ç»“æœçš„ Canvas
     */
    async stitchImages(img1, img2) {
        console.log(`å¤„ç†å›¾ç‰‡: ${img1.width}x${img1.height} + ${img2.width}x${img2.height}`);

        // ç¡®ä¿ä¸¤å¼ å›¾ç‰‡å®½åº¦ç›¸åŒ
        let processedImg1 = img1;
        if (img1.width !== img2.width) {
            console.log(`è°ƒæ•´å›¾ç‰‡å®½åº¦: ${img1.width} -> ${img2.width}`);
            processedImg1 = await this.resizeImage(img1, img2.width, Math.floor(img1.height * img2.width / img1.width));
        }

        // è·å–å›¾ç‰‡æ•°æ®
        const img1Data = this.imageToImageData(processedImg1);
        const img2Data = this.imageToImageData(img2);

        console.log(`å¿½ç•¥å³ä¾§ ${this.ignoreRightPixels} åƒç´ æ¥æ’é™¤æ»šåŠ¨æ¡å½±å“`);
        
        // è½¬æ¢ä¸ºè¡Œå“ˆå¸Œ
        const img1Hashes = this.imageToRowHashes(img1Data.imageData, this.ignoreRightPixels);
        const img2Hashes = this.imageToRowHashes(img2Data.imageData, this.ignoreRightPixels);

        // å¯»æ‰¾é‡å åŒºåŸŸ
        const overlap = this.findBestOverlap(img1Hashes, img2Hashes);

        // åˆ›å»ºç»“æœ Canvas
        const resultCanvas = document.createElement('canvas');
        const resultCtx = resultCanvas.getContext('2d');

        if (overlap.length === 0) {
            console.log("æœªæ‰¾åˆ°é‡å åŒºåŸŸï¼Œç›´æ¥æ‹¼æ¥");
            // ç›´æ¥æ‹¼æ¥
            resultCanvas.width = img2.width;
            resultCanvas.height = processedImg1.height + img2.height;
            
            resultCtx.drawImage(processedImg1, 0, 0);
            resultCtx.drawImage(img2, 0, processedImg1.height);
        } else {
            const { seq1Start: img1Start, seq2Start: img2Start, length: overlapLength } = overlap;
            console.log(`æ‰¾åˆ°é‡å åŒºåŸŸ: img1[${img1Start}:${img1Start + overlapLength}] = img2[${img2Start}:${img2Start + overlapLength}]`);

            // è®¡ç®—æ‹¼æ¥åçš„æ€»é«˜åº¦
            const img1KeepHeight = img1Start + overlapLength;
            const img2SkipHeight = img2Start + overlapLength;
            const img2KeepHeight = img2.height - img2SkipHeight;
            const resultHeight = img1KeepHeight + img2KeepHeight;

            console.log(`æ‹¼æ¥è®¡ç®—: img1ä¿ç•™${img1KeepHeight}è¡Œ + img2è·³è¿‡${img2SkipHeight}è¡Œä¿ç•™${img2KeepHeight}è¡Œ = æ€»è®¡${resultHeight}è¡Œ`);

            resultCanvas.width = img2.width;
            resultCanvas.height = resultHeight;

            // ç»˜åˆ¶img1çš„ä¿ç•™éƒ¨åˆ†
            resultCtx.drawImage(
                processedImg1,
                0, 0, processedImg1.width, img1KeepHeight,
                0, 0, processedImg1.width, img1KeepHeight
            );

            // ç»˜åˆ¶img2çš„å‰©ä½™éƒ¨åˆ†
            if (img2KeepHeight > 0) {
                resultCtx.drawImage(
                    img2,
                    0, img2SkipHeight, img2.width, img2KeepHeight,
                    0, img1KeepHeight, img2.width, img2KeepHeight
                );
            }
        }

        return resultCanvas;
    }

    /**
     * è°ƒæ•´å›¾ç‰‡å°ºå¯¸
     * @param {HTMLImageElement} img - åŸå›¾ç‰‡
     * @param {number} newWidth - æ–°å®½åº¦
     * @param {number} newHeight - æ–°é«˜åº¦
     * @returns {Promise<HTMLImageElement>} è°ƒæ•´åçš„å›¾ç‰‡
     */
    async resizeImage(img, newWidth, newHeight) {
        return new Promise((resolve) => {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = newWidth;
            canvas.height = newHeight;
            
            ctx.drawImage(img, 0, 0, newWidth, newHeight);
            
            const resizedImg = new Image();
            resizedImg.onload = () => resolve(resizedImg);
            resizedImg.src = canvas.toDataURL();
        });
    }

    /**
     * æ‹¼æ¥å¤šå¼ å›¾ç‰‡
     * @param {Array<File>} imageFiles - å›¾ç‰‡æ–‡ä»¶æ•°ç»„
     * @param {Function} progressCallback - è¿›åº¦å›è°ƒå‡½æ•°
     * @returns {Promise<HTMLCanvasElement>} æ‹¼æ¥ç»“æœçš„ Canvas
     */
    async stitchMultipleImages(imageFiles, progressCallback = null) {
        if (imageFiles.length < 2) {
            throw new Error("è‡³å°‘éœ€è¦ä¸¤å¼ å›¾ç‰‡è¿›è¡Œæ‹¼æ¥");
        }

        console.log(`å¼€å§‹æ‹¼æ¥ ${imageFiles.length} å¼ å›¾ç‰‡...`);

        // åŠ è½½æ‰€æœ‰å›¾ç‰‡
        const images = [];
        for (let i = 0; i < imageFiles.length; i++) {
            const img = await this.loadImage(imageFiles[i]);
            images.push(img);
            if (progressCallback) {
                progressCallback({
                    stage: 'loading',
                    current: i + 1,
                    total: imageFiles.length
                });
            }
        }

        // é€ä¸ªæ‹¼æ¥
        let result = images[0];
        console.log(`åŸºç¡€å›¾ç‰‡: ${result.width}x${result.height}`);

        for (let i = 1; i < images.length; i++) {
            console.log(`\næ‹¼æ¥ç¬¬ ${i + 1} å¼ å›¾ç‰‡`);
            
            // å¦‚æœ result æ˜¯ Canvasï¼Œéœ€è¦è½¬æ¢ä¸º Image
            if (result instanceof HTMLCanvasElement) {
                const tempImg = new Image();
                tempImg.src = result.toDataURL();
                await new Promise(resolve => {
                    tempImg.onload = resolve;
                });
                result = tempImg;
            }

            result = await this.stitchImages(result, images[i]);
            console.log(`å½“å‰ç»“æœå°ºå¯¸: ${result.width}x${result.height}`);

            if (progressCallback) {
                progressCallback({
                    stage: 'stitching',
                    current: i,
                    total: images.length - 1
                });
            }
        }

        console.log(`æ‹¼æ¥å®Œæˆ! æœ€ç»ˆå°ºå¯¸: ${result.width}x${result.height}`);
        return result;
    }

    /**
     * ä»æ–‡ä»¶åŠ è½½å›¾ç‰‡
     * @param {File} file - å›¾ç‰‡æ–‡ä»¶
     * @returns {Promise<HTMLImageElement>} åŠ è½½çš„å›¾ç‰‡
     */
    loadImage(file) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            const url = URL.createObjectURL(file);
            
            img.onload = () => {
                URL.revokeObjectURL(url);
                resolve(img);
            };
            
            img.onerror = () => {
                URL.revokeObjectURL(url);
                reject(new Error(`æ— æ³•åŠ è½½å›¾ç‰‡: ${file.name}`));
            };
            
            img.src = url;
        });
    }

    /**
     * è®¾ç½®å¿½ç•¥å³ä¾§åƒç´ æ•°é‡
     * @param {number} pixels - åƒç´ æ•°é‡
     */
    setIgnoreRightPixels(pixels) {
        this.ignoreRightPixels = Math.max(0, pixels);
    }
}

// å¯¼å‡ºç±»ä¾›å…¶ä»–è„šæœ¬ä½¿ç”¨
if (typeof module !== 'undefined' && module.exports) {
    module.exports = LongScreenshotStitcher;
}

```

ç°åœ¨æ·»åŠ æ›´å¤šæ€§èƒ½ä¼˜åŒ–ï¼ŒåŒ…æ‹¬ Web Workers æ”¯æŒå’Œå†…å­˜ä¼˜åŒ–ï¼š

```javascript
/**
 * é•¿æˆªå›¾æ‹¼æ¥å·¥å…· - JavaScript ç‰ˆæœ¬
 * ä½¿ç”¨æœ€é•¿å…¬å…±å­ä¸²ç®—æ³•æ‰¾åˆ°å›¾ç‰‡é‡å éƒ¨åˆ†å¹¶è¿›è¡Œæ‹¼æ¥
 */

class LongScreenshotStitcher {
    constructor() {
        this.ignoreRightPixels = 20; // å¿½ç•¥å³ä¾§åƒç´ æ•°é‡ï¼Œç”¨äºæ’é™¤æ»šåŠ¨æ¡å½±å“
    }

    /**
     * å°†å›¾ç‰‡çš„æ¯ä¸€è¡Œè½¬æ¢ä¸ºå“ˆå¸Œå€¼ï¼Œç”¨äºå¿«é€Ÿæ¯”è¾ƒ
     * @param {ImageData} imageData - Canvas ImageData å¯¹è±¡
     * @param {number} ignoreRightPixels - å¿½ç•¥å³ä¾§å¤šå°‘åƒç´ 
     * @returns {Array<number>} è¡Œå“ˆå¸Œæ•°ç»„
     */
    imageToRowHashes(imageData, ignoreRightPixels = 20) {
        const { width, height, data } = imageData;
        const rowHashes = [];
        const effectiveWidth = Math.max(0, width - ignoreRightPixels);

        // æ‰¹é‡å¤„ç†ä»¥æé«˜æ€§èƒ½
        for (let y = 0; y < height; y++) {
            const rowStart = y * width * 4;
            
            // ä½¿ç”¨æ›´é«˜æ•ˆçš„é‡‡æ ·ç­–ç•¥ - æ¯éš”å‡ ä¸ªåƒç´ é‡‡æ ·ä¸€æ¬¡
            const sampleStep = Math.max(1, Math.floor(effectiveWidth / 100)); // æœ€å¤šé‡‡æ ·100ä¸ªç‚¹
            let sumR = 0, sumG = 0, sumB = 0;
            let sampleCount = 0;

            for (let x = 0; x < effectiveWidth; x += sampleStep) {
                const pixelIndex = rowStart + x * 4;
                sumR += data[pixelIndex];     // R
                sumG += data[pixelIndex + 1]; // G
                sumB += data[pixelIndex + 2]; // B
                sampleCount++;
            }

            if (sampleCount > 0) {
                // è®¡ç®—å¹³å‡å€¼å¹¶é‡åŒ–ä»¥æé«˜å®¹å¿åº¦
                const avgR = Math.floor((sumR / sampleCount) / 16) * 16; // å¢å¤§é‡åŒ–æ­¥é•¿
                const avgG = Math.floor((sumG / sampleCount) / 16) * 16;
                const avgB = Math.floor((sumB / sampleCount) / 16) * 16;
                
                // æ›´é«˜æ•ˆçš„å“ˆå¸Œå‡½æ•°
                const hash = (avgR << 16) | (avgG << 8) | avgB;
                rowHashes.push(hash);
            } else {
                rowHashes.push(0);
            }
        }

        return rowHashes;
    }

    /**
     * æ‰¾åˆ°ä¸¤ä¸ªåºåˆ—çš„æœ€é•¿å…¬å…±å­ä¸²
     * @param {Array<number>} seq1 - ç¬¬ä¸€ä¸ªåºåˆ—
     * @param {Array<number>} seq2 - ç¬¬äºŒä¸ªåºåˆ—
     * @param {number} minRatio - æœ€å°é‡å æ¯”ä¾‹é˜ˆå€¼
     * @returns {Object} {seq1Start, seq2Start, length}
     */
    findLongestCommonSubstring(seq1, seq2, minRatio = 0.01) {
        const m = seq1.length;
        const n = seq2.length;
        const minLength = Math.floor(Math.min(m, n) * minRatio);

        // åŠ¨æ€è§„åˆ’è¡¨
        const dp = Array(m + 1).fill(0).map(() => Array(n + 1).fill(0));

        let maxLength = 0;
        let endingPosI = 0;
        let endingPosJ = 0;

        for (let i = 1; i <= m; i++) {
            for (let j = 1; j <= n; j++) {
                if (seq1[i - 1] === seq2[j - 1]) {
                    dp[i][j] = dp[i - 1][j - 1] + 1;
                    if (dp[i][j] > maxLength) {
                        maxLength = dp[i][j];
                        endingPosI = i;
                        endingPosJ = j;
                    }
                } else {
                    dp[i][j] = 0;
                }
            }
        }

        if (maxLength < minLength) {
            return { seq1Start: -1, seq2Start: -1, length: 0 };
        }

        const seq1Start = endingPosI - maxLength;
        const seq2Start = endingPosJ - maxLength;

        return { seq1Start, seq2Start, length: maxLength };
    }

    /**
     * å¯»æ‰¾æœ€ä½³é‡å åŒºåŸŸ
     * @param {Array<number>} img1Hashes - ç¬¬ä¸€å¼ å›¾ç‰‡çš„è¡Œå“ˆå¸Œ
     * @param {Array<number>} img2Hashes - ç¬¬äºŒå¼ å›¾ç‰‡çš„è¡Œå“ˆå¸Œ
     * @returns {Object} é‡å ä¿¡æ¯
     */
    findBestOverlap(img1Hashes, img2Hashes) {
        console.log(`æœç´¢é‡å åŒºåŸŸ: img1æœ‰${img1Hashes.length}è¡Œ, img2æœ‰${img2Hashes.length}è¡Œ`);

        const overlap = this.findLongestCommonSubstring(img1Hashes, img2Hashes, 0.01);

        if (overlap.length > 0) {
            const overlapRatio = overlap.length / Math.min(img1Hashes.length, img2Hashes.length);
            console.log(`æ‰¾åˆ°é‡å : é•¿åº¦${overlap.length}è¡Œ, å æ¯”${(overlapRatio * 100).toFixed(2)}%`);
            return overlap;
        } else {
            console.log("æœªæ‰¾åˆ°ä»»ä½•é‡å åŒºåŸŸ");
            return { seq1Start: -1, seq2Start: -1, length: 0 };
        }
    }

    /**
     * å°†å›¾ç‰‡ç»˜åˆ¶åˆ° Canvas å¹¶è·å– ImageData
     * @param {HTMLImageElement} img - å›¾ç‰‡å…ƒç´ 
     * @returns {Object} {canvas, ctx, imageData}
     */
    imageToImageData(img) {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d', {
            alpha: false,  // ç¦ç”¨ alpha é€šé“ä»¥æé«˜æ€§èƒ½
            desynchronized: true  // å¯ç”¨å¼‚æ­¥æ¸²æŸ“
        });
        
        canvas.width = img.width;
        canvas.height = img.height;
        
        // ä½¿ç”¨é«˜è´¨é‡å›¾åƒå¹³æ»‘ç®—æ³•
        ctx.imageSmoothingEnabled = true;
        ctx.imageSmoothingQuality = 'high';
        
        ctx.drawImage(img, 0, 0);
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        
        return { canvas, ctx, imageData };
    }

    /**
     * æ‹¼æ¥ä¸¤å¼ å›¾ç‰‡
     * @param {HTMLImageElement} img1 - ç¬¬ä¸€å¼ å›¾ç‰‡
     * @param {HTMLImageElement} img2 - ç¬¬äºŒå¼ å›¾ç‰‡
     * @returns {Promise<HTMLCanvasElement>} æ‹¼æ¥ç»“æœçš„ Canvas
     */
    async stitchImages(img1, img2) {
        console.log(`å¤„ç†å›¾ç‰‡: ${img1.width}x${img1.height} + ${img2.width}x${img2.height}`);

        // ç¡®ä¿ä¸¤å¼ å›¾ç‰‡å®½åº¦ç›¸åŒ
        let processedImg1 = img1;
        if (img1.width !== img2.width) {
            console.log(`è°ƒæ•´å›¾ç‰‡å®½åº¦: ${img1.width} -> ${img2.width}`);
            processedImg1 = await this.resizeImage(img1, img2.width, Math.floor(img1.height * img2.width / img1.width));
        }

        // è·å–å›¾ç‰‡æ•°æ®
        const img1Data = this.imageToImageData(processedImg1);
        const img2Data = this.imageToImageData(img2);

        console.log(`å¿½ç•¥å³ä¾§ ${this.ignoreRightPixels} åƒç´ æ¥æ’é™¤æ»šåŠ¨æ¡å½±å“`);
        
        // è½¬æ¢ä¸ºè¡Œå“ˆå¸Œ
        const img1Hashes = this.imageToRowHashes(img1Data.imageData, this.ignoreRightPixels);
        const img2Hashes = this.imageToRowHashes(img2Data.imageData, this.ignoreRightPixels);

        // å¯»æ‰¾é‡å åŒºåŸŸ
        const overlap = this.findBestOverlap(img1Hashes, img2Hashes);

        // åˆ›å»ºç»“æœ Canvas
        const resultCanvas = document.createElement('canvas');
        const resultCtx = resultCanvas.getContext('2d');

        if (overlap.length === 0) {
            console.log("æœªæ‰¾åˆ°é‡å åŒºåŸŸï¼Œç›´æ¥æ‹¼æ¥");
            // ç›´æ¥æ‹¼æ¥
            resultCanvas.width = img2.width;
            resultCanvas.height = processedImg1.height + img2.height;
            
            resultCtx.drawImage(processedImg1, 0, 0);
            resultCtx.drawImage(img2, 0, processedImg1.height);
        } else {
            const { seq1Start: img1Start, seq2Start: img2Start, length: overlapLength } = overlap;
            console.log(`æ‰¾åˆ°é‡å åŒºåŸŸ: img1[${img1Start}:${img1Start + overlapLength}] = img2[${img2Start}:${img2Start + overlapLength}]`);

            // è®¡ç®—æ‹¼æ¥åçš„æ€»é«˜åº¦
            const img1KeepHeight = img1Start + overlapLength;
            const img2SkipHeight = img2Start + overlapLength;
            const img2KeepHeight = img2.height - img2SkipHeight;
            const resultHeight = img1KeepHeight + img2KeepHeight;

            console.log(`æ‹¼æ¥è®¡ç®—: img1ä¿ç•™${img1KeepHeight}è¡Œ + img2è·³è¿‡${img2SkipHeight}è¡Œä¿ç•™${img2KeepHeight}è¡Œ = æ€»è®¡${resultHeight}è¡Œ`);

            resultCanvas.width = img2.width;
            resultCanvas.height = resultHeight;

            // ç»˜åˆ¶img1çš„ä¿ç•™éƒ¨åˆ†
            resultCtx.drawImage(
                processedImg1,
                0, 0, processedImg1.width, img1KeepHeight,
                0, 0, processedImg1.width, img1KeepHeight
            );

            // ç»˜åˆ¶img2çš„å‰©ä½™éƒ¨åˆ†
            if (img2KeepHeight > 0) {
                resultCtx.drawImage(
                    img2,
                    0, img2SkipHeight, img2.width, img2KeepHeight,
                    0, img1KeepHeight, img2.width, img2KeepHeight
                );
            }
        }

        return resultCanvas;
    }

    /**
     * è°ƒæ•´å›¾ç‰‡å°ºå¯¸
     * @param {HTMLImageElement} img - åŸå›¾ç‰‡
     * @param {number} newWidth - æ–°å®½åº¦
     * @param {number} newHeight - æ–°é«˜åº¦
     * @returns {Promise<HTMLImageElement>} è°ƒæ•´åçš„å›¾ç‰‡
     */
    async resizeImage(img, newWidth, newHeight) {
        return new Promise((resolve) => {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = newWidth;
            canvas.height = newHeight;
            
            ctx.drawImage(img, 0, 0, newWidth, newHeight);
            
            const resizedImg = new Image();
            resizedImg.onload = () => resolve(resizedImg);
            resizedImg.src = canvas.toDataURL();
        });
    }

    /**
     * æ‹¼æ¥å¤šå¼ å›¾ç‰‡
     * @param {Array<File>} imageFiles - å›¾ç‰‡æ–‡ä»¶æ•°ç»„
     * @param {Function} progressCallback - è¿›åº¦å›è°ƒå‡½æ•°
     * @returns {Promise<HTMLCanvasElement>} æ‹¼æ¥ç»“æœçš„ Canvas
     */
    async stitchMultipleImages(imageFiles, progressCallback = null) {
        if (imageFiles.length < 2) {
            throw new Error("è‡³å°‘éœ€è¦ä¸¤å¼ å›¾ç‰‡è¿›è¡Œæ‹¼æ¥");
        }

        console.log(`å¼€å§‹æ‹¼æ¥ ${imageFiles.length} å¼ å›¾ç‰‡...`);

        // åŠ è½½æ‰€æœ‰å›¾ç‰‡
        const images = [];
        for (let i = 0; i < imageFiles.length; i++) {
            const img = await this.loadImage(imageFiles[i]);
            images.push(img);
            if (progressCallback) {
                progressCallback({
                    stage: 'loading',
                    current: i + 1,
                    total: imageFiles.length
                });
            }
        }

        // é€ä¸ªæ‹¼æ¥
        let result = images[0];
        console.log(`åŸºç¡€å›¾ç‰‡: ${result.width}x${result.height}`);

        for (let i = 1; i < images.length; i++) {
            console.log(`\næ‹¼æ¥ç¬¬ ${i + 1} å¼ å›¾ç‰‡`);
            
            // å¦‚æœ result æ˜¯ Canvasï¼Œéœ€è¦è½¬æ¢ä¸º Image
            if (result instanceof HTMLCanvasElement) {
                const tempImg = new Image();
                tempImg.src = result.toDataURL();
                await new Promise(resolve => {
                    tempImg.onload = resolve;
                });
                result = tempImg;
            }

            result = await this.stitchImages(result, images[i]);
            console.log(`å½“å‰ç»“æœå°ºå¯¸: ${result.width}x${result.height}`);

            if (progressCallback) {
                progressCallback({
                    stage: 'stitching',
                    current: i,
                    total: images.length - 1
                });
            }
        }

        console.log(`æ‹¼æ¥å®Œæˆ! æœ€ç»ˆå°ºå¯¸: ${result.width}x${result.height}`);
        return result;
    }

    /**
     * ä»æ–‡ä»¶åŠ è½½å›¾ç‰‡
     * @param {File} file - å›¾ç‰‡æ–‡ä»¶
     * @returns {Promise<HTMLImageElement>} åŠ è½½çš„å›¾ç‰‡
     */
    loadImage(file) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            const url = URL.createObjectURL(file);
            
            img.onload = () => {
                URL.revokeObjectURL(url);
                resolve(img);
            };
            
            img.onerror = () => {
                URL.revokeObjectURL(url);
                reject(new Error(`æ— æ³•åŠ è½½å›¾ç‰‡: ${file.name}`));
            };
            
            img.src = url;
        });
    }

    /**
     * è®¾ç½®å¿½ç•¥å³ä¾§åƒç´ æ•°é‡
     * @param {number} pixels - åƒç´ æ•°é‡
     */
    setIgnoreRightPixels(pixels) {
        this.ignoreRightPixels = Math.max(0, pixels);
    }
}

// å¯¼å‡ºç±»ä¾›å…¶ä»–è„šæœ¬ä½¿ç”¨
if (typeof module !== 'undefined' && module.exports) {
    module.exports = LongScreenshotStitcher;
}

```

```javascript
/**
 * é•¿æˆªå›¾æ‹¼æ¥å·¥å…· - JavaScript ç‰ˆæœ¬
 * ä½¿ç”¨æœ€é•¿å…¬å…±å­ä¸²ç®—æ³•æ‰¾åˆ°å›¾ç‰‡é‡å éƒ¨åˆ†å¹¶è¿›è¡Œæ‹¼æ¥
 */

class LongScreenshotStitcher {
    constructor() {
        this.ignoreRightPixels = 20; // å¿½ç•¥å³ä¾§åƒç´ æ•°é‡ï¼Œç”¨äºæ’é™¤æ»šåŠ¨æ¡å½±å“
    }

    /**
     * å°†å›¾ç‰‡çš„æ¯ä¸€è¡Œè½¬æ¢ä¸ºå“ˆå¸Œå€¼ï¼Œç”¨äºå¿«é€Ÿæ¯”è¾ƒ
     * @param {ImageData} imageData - Canvas ImageData å¯¹è±¡
     * @param {number} ignoreRightPixels - å¿½ç•¥å³ä¾§å¤šå°‘åƒç´ 
     * @returns {Array<number>} è¡Œå“ˆå¸Œæ•°ç»„
     */
    imageToRowHashes(imageData, ignoreRightPixels = 20) {
        const { width, height, data } = imageData;
        const rowHashes = [];
        const effectiveWidth = Math.max(0, width - ignoreRightPixels);

        // æ‰¹é‡å¤„ç†ä»¥æé«˜æ€§èƒ½
        for (let y = 0; y < height; y++) {
            const rowStart = y * width * 4;
            
            // ä½¿ç”¨æ›´é«˜æ•ˆçš„é‡‡æ ·ç­–ç•¥ - æ¯éš”å‡ ä¸ªåƒç´ é‡‡æ ·ä¸€æ¬¡
            const sampleStep = Math.max(1, Math.floor(effectiveWidth / 100)); // æœ€å¤šé‡‡æ ·100ä¸ªç‚¹
            let sumR = 0, sumG = 0, sumB = 0;
            let sampleCount = 0;

            for (let x = 0; x < effectiveWidth; x += sampleStep) {
                const pixelIndex = rowStart + x * 4;
                sumR += data[pixelIndex];     // R
                sumG += data[pixelIndex + 1]; // G
                sumB += data[pixelIndex + 2]; // B
                sampleCount++;
            }

            if (sampleCount > 0) {
                // è®¡ç®—å¹³å‡å€¼å¹¶é‡åŒ–ä»¥æé«˜å®¹å¿åº¦
                const avgR = Math.floor((sumR / sampleCount) / 16) * 16; // å¢å¤§é‡åŒ–æ­¥é•¿
                const avgG = Math.floor((sumG / sampleCount) / 16) * 16;
                const avgB = Math.floor((sumB / sampleCount) / 16) * 16;
                
                // æ›´é«˜æ•ˆçš„å“ˆå¸Œå‡½æ•°
                const hash = (avgR << 16) | (avgG << 8) | avgB;
                rowHashes.push(hash);
            } else {
                rowHashes.push(0);
            }
        }

        return rowHashes;
    }

    /**
     * æ‰¾åˆ°ä¸¤ä¸ªåºåˆ—çš„æœ€é•¿å…¬å…±å­ä¸²
     * @param {Array<number>} seq1 - ç¬¬ä¸€ä¸ªåºåˆ—
     * @param {Array<number>} seq2 - ç¬¬äºŒä¸ªåºåˆ—
     * @param {number} minRatio - æœ€å°é‡å æ¯”ä¾‹é˜ˆå€¼
     * @returns {Object} {seq1Start, seq2Start, length}
     */
    findLongestCommonSubstring(seq1, seq2, minRatio = 0.01) {
        const m = seq1.length;
        const n = seq2.length;
        const minLength = Math.floor(Math.min(m, n) * minRatio);

        // åŠ¨æ€è§„åˆ’è¡¨
        const dp = Array(m + 1).fill(0).map(() => Array(n + 1).fill(0));

        let maxLength = 0;
        let endingPosI = 0;
        let endingPosJ = 0;

        for (let i = 1; i <= m; i++) {
            for (let j = 1; j <= n; j++) {
                if (seq1[i - 1] === seq2[j - 1]) {
                    dp[i][j] = dp[i - 1][j - 1] + 1;
                    if (dp[i][j] > maxLength) {
                        maxLength = dp[i][j];
                        endingPosI = i;
                        endingPosJ = j;
                    }
                } else {
                    dp[i][j] = 0;
                }
            }
        }

        if (maxLength < minLength) {
            return { seq1Start: -1, seq2Start: -1, length: 0 };
        }

        const seq1Start = endingPosI - maxLength;
        const seq2Start = endingPosJ - maxLength;

        return { seq1Start, seq2Start, length: maxLength };
    }

    /**
     * å¯»æ‰¾æœ€ä½³é‡å åŒºåŸŸ
     * @param {Array<number>} img1Hashes - ç¬¬ä¸€å¼ å›¾ç‰‡çš„è¡Œå“ˆå¸Œ
     * @param {Array<number>} img2Hashes - ç¬¬äºŒå¼ å›¾ç‰‡çš„è¡Œå“ˆå¸Œ
     * @returns {Object} é‡å ä¿¡æ¯
     */
    findBestOverlap(img1Hashes, img2Hashes) {
        console.log(`æœç´¢é‡å åŒºåŸŸ: img1æœ‰${img1Hashes.length}è¡Œ, img2æœ‰${img2Hashes.length}è¡Œ`);

        const overlap = this.findLongestCommonSubstring(img1Hashes, img2Hashes, 0.01);

        if (overlap.length > 0) {
            const overlapRatio = overlap.length / Math.min(img1Hashes.length, img2Hashes.length);
            console.log(`æ‰¾åˆ°é‡å : é•¿åº¦${overlap.length}è¡Œ, å æ¯”${(overlapRatio * 100).toFixed(2)}%`);
            return overlap;
        } else {
            console.log("æœªæ‰¾åˆ°ä»»ä½•é‡å åŒºåŸŸ");
            return { seq1Start: -1, seq2Start: -1, length: 0 };
        }
    }

    /**
     * å°†å›¾ç‰‡ç»˜åˆ¶åˆ° Canvas å¹¶è·å– ImageData
     * @param {HTMLImageElement} img - å›¾ç‰‡å…ƒç´ 
     * @returns {Object} {canvas, ctx, imageData}
     */
    imageToImageData(img) {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d', {
            alpha: false,  // ç¦ç”¨ alpha é€šé“ä»¥æé«˜æ€§èƒ½
            desynchronized: true  // å¯ç”¨å¼‚æ­¥æ¸²æŸ“
        });
        
        canvas.width = img.width;
        canvas.height = img.height;
        
        // ä½¿ç”¨é«˜è´¨é‡å›¾åƒå¹³æ»‘ç®—æ³•
        ctx.imageSmoothingEnabled = true;
        ctx.imageSmoothingQuality = 'high';
        
        ctx.drawImage(img, 0, 0);
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        
        return { canvas, ctx, imageData };
    }

    /**
     * æ‹¼æ¥ä¸¤å¼ å›¾ç‰‡
     * @param {HTMLImageElement} img1 - ç¬¬ä¸€å¼ å›¾ç‰‡
     * @param {HTMLImageElement} img2 - ç¬¬äºŒå¼ å›¾ç‰‡
     * @returns {Promise<HTMLCanvasElement>} æ‹¼æ¥ç»“æœçš„ Canvas
     */
    async stitchImages(img1, img2) {
        console.log(`å¤„ç†å›¾ç‰‡: ${img1.width}x${img1.height} + ${img2.width}x${img2.height}`);

        // ç¡®ä¿ä¸¤å¼ å›¾ç‰‡å®½åº¦ç›¸åŒ
        let processedImg1 = img1;
        if (img1.width !== img2.width) {
            console.log(`è°ƒæ•´å›¾ç‰‡å®½åº¦: ${img1.width} -> ${img2.width}`);
            processedImg1 = await this.resizeImage(img1, img2.width, Math.floor(img1.height * img2.width / img1.width));
        }

        // è·å–å›¾ç‰‡æ•°æ®
        const img1Data = this.imageToImageData(processedImg1);
        const img2Data = this.imageToImageData(img2);

        console.log(`å¿½ç•¥å³ä¾§ ${this.ignoreRightPixels} åƒç´ æ¥æ’é™¤æ»šåŠ¨æ¡å½±å“`);
        
        // è½¬æ¢ä¸ºè¡Œå“ˆå¸Œ
        const img1Hashes = this.imageToRowHashes(img1Data.imageData, this.ignoreRightPixels);
        const img2Hashes = this.imageToRowHashes(img2Data.imageData, this.ignoreRightPixels);

        // å¯»æ‰¾é‡å åŒºåŸŸ
        const overlap = this.findBestOverlap(img1Hashes, img2Hashes);

        // åˆ›å»ºç»“æœ Canvasï¼Œä¼˜åŒ–è®¾ç½®
        const resultCanvas = document.createElement('canvas');
        const resultCtx = resultCanvas.getContext('2d', {
            alpha: false,
            desynchronized: true
        });

        if (overlap.length === 0) {
            console.log("æœªæ‰¾åˆ°é‡å åŒºåŸŸï¼Œç›´æ¥æ‹¼æ¥");
            // ç›´æ¥æ‹¼æ¥
            resultCanvas.width = img2.width;
            resultCanvas.height = processedImg1.height + img2.height;
            
            resultCtx.drawImage(processedImg1, 0, 0);
            resultCtx.drawImage(img2, 0, processedImg1.height);
        } else {
            const { seq1Start: img1Start, seq2Start: img2Start, length: overlapLength } = overlap;
            console.log(`æ‰¾åˆ°é‡å åŒºåŸŸ: img1[${img1Start}:${img1Start + overlapLength}] = img2[${img2Start}:${img2Start + overlapLength}]`);

            // è®¡ç®—æ‹¼æ¥åçš„æ€»é«˜åº¦
            const img1KeepHeight = img1Start + overlapLength;
            const img2SkipHeight = img2Start + overlapLength;
            const img2KeepHeight = img2.height - img2SkipHeight;
            const resultHeight = img1KeepHeight + img2KeepHeight;

            console.log(`æ‹¼æ¥è®¡ç®—: img1ä¿ç•™${img1KeepHeight}è¡Œ + img2è·³è¿‡${img2SkipHeight}è¡Œä¿ç•™${img2KeepHeight}è¡Œ = æ€»è®¡${resultHeight}è¡Œ`);

            resultCanvas.width = img2.width;
            resultCanvas.height = resultHeight;

            // ç»˜åˆ¶img1çš„ä¿ç•™éƒ¨åˆ†
            resultCtx.drawImage(
                processedImg1,
                0, 0, processedImg1.width, img1KeepHeight,
                0, 0, processedImg1.width, img1KeepHeight
            );

            // ç»˜åˆ¶img2çš„å‰©ä½™éƒ¨åˆ†
            if (img2KeepHeight > 0) {
                resultCtx.drawImage(
                    img2,
                    0, img2SkipHeight, img2.width, img2KeepHeight,
                    0, img1KeepHeight, img2.width, img2KeepHeight
                );
            }
        }

        return resultCanvas;
    }

    /**
     * è°ƒæ•´å›¾ç‰‡å°ºå¯¸
     * @param {HTMLImageElement} img - åŸå›¾ç‰‡
     * @param {number} newWidth - æ–°å®½åº¦
     * @param {number} newHeight - æ–°é«˜åº¦
     * @returns {Promise<HTMLImageElement>} è°ƒæ•´åçš„å›¾ç‰‡
     */
    async resizeImage(img, newWidth, newHeight) {
        return new Promise((resolve) => {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = newWidth;
            canvas.height = newHeight;
            
            ctx.drawImage(img, 0, 0, newWidth, newHeight);
            
            const resizedImg = new Image();
            resizedImg.onload = () => resolve(resizedImg);
            resizedImg.src = canvas.toDataURL();
        });
    }

    /**
     * æ‹¼æ¥å¤šå¼ å›¾ç‰‡
     * @param {Array<File>} imageFiles - å›¾ç‰‡æ–‡ä»¶æ•°ç»„
     * @param {Function} progressCallback - è¿›åº¦å›è°ƒå‡½æ•°
     * @returns {Promise<HTMLCanvasElement>} æ‹¼æ¥ç»“æœçš„ Canvas
     */
    async stitchMultipleImages(imageFiles, progressCallback = null) {
        if (imageFiles.length < 2) {
            throw new Error("è‡³å°‘éœ€è¦ä¸¤å¼ å›¾ç‰‡è¿›è¡Œæ‹¼æ¥");
        }

        console.log(`å¼€å§‹æ‹¼æ¥ ${imageFiles.length} å¼ å›¾ç‰‡...`);

        // åŠ è½½æ‰€æœ‰å›¾ç‰‡
        const images = [];
        for (let i = 0; i < imageFiles.length; i++) {
            const img = await this.loadImage(imageFiles[i]);
            images.push(img);
            if (progressCallback) {
                progressCallback({
                    stage: 'loading',
                    current: i + 1,
                    total: imageFiles.length
                });
            }
        }

        // é€ä¸ªæ‹¼æ¥
        let result = images[0];
        console.log(`åŸºç¡€å›¾ç‰‡: ${result.width}x${result.height}`);

        for (let i = 1; i < images.length; i++) {
            console.log(`\næ‹¼æ¥ç¬¬ ${i + 1} å¼ å›¾ç‰‡`);
            
            // å¦‚æœ result æ˜¯ Canvasï¼Œéœ€è¦è½¬æ¢ä¸º Image
            if (result instanceof HTMLCanvasElement) {
                const tempImg = new Image();
                tempImg.src = result.toDataURL();
                await new Promise(resolve => {
                    tempImg.onload = resolve;
                });
                result = tempImg;
            }

            result = await this.stitchImages(result, images[i]);
            console.log(`å½“å‰ç»“æœå°ºå¯¸: ${result.width}x${result.height}`);

            if (progressCallback) {
                progressCallback({
                    stage: 'stitching',
                    current: i,
                    total: images.length - 1
                });
            }
        }

        console.log(`æ‹¼æ¥å®Œæˆ! æœ€ç»ˆå°ºå¯¸: ${result.width}x${result.height}`);
        return result;
    }

    /**
     * ä»æ–‡ä»¶åŠ è½½å›¾ç‰‡
     * @param {File} file - å›¾ç‰‡æ–‡ä»¶
     * @returns {Promise<HTMLImageElement>} åŠ è½½çš„å›¾ç‰‡
     */
    loadImage(file) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            const url = URL.createObjectURL(file);
            
            img.onload = () => {
                URL.revokeObjectURL(url);
                resolve(img);
            };
            
            img.onerror = () => {
                URL.revokeObjectURL(url);
                reject(new Error(`æ— æ³•åŠ è½½å›¾ç‰‡: ${file.name}`));
            };
            
            img.src = url;
        });
    }

    /**
     * è®¾ç½®å¿½ç•¥å³ä¾§åƒç´ æ•°é‡
     * @param {number} pixels - åƒç´ æ•°é‡
     */
    setIgnoreRightPixels(pixels) {
        this.ignoreRightPixels = Math.max(0, pixels);
    }
}

// å¯¼å‡ºç±»ä¾›å…¶ä»–è„šæœ¬ä½¿ç”¨
if (typeof module !== 'undefined' && module.exports) {
    module.exports = LongScreenshotStitcher;
}

```

ç°åœ¨æ·»åŠ å†…å­˜ç®¡ç†å’ŒåŠ è½½ä¼˜åŒ–åŠŸèƒ½ï¼š

```javascript
/**
 * é•¿æˆªå›¾æ‹¼æ¥å·¥å…· - JavaScript ç‰ˆæœ¬
 * ä½¿ç”¨æœ€é•¿å…¬å…±å­ä¸²ç®—æ³•æ‰¾åˆ°å›¾ç‰‡é‡å éƒ¨åˆ†å¹¶è¿›è¡Œæ‹¼æ¥
 */

class LongScreenshotStitcher {
    constructor() {
        this.ignoreRightPixels = 20; // å¿½ç•¥å³ä¾§åƒç´ æ•°é‡ï¼Œç”¨äºæ’é™¤æ»šåŠ¨æ¡å½±å“
    }

    /**
     * å°†å›¾ç‰‡çš„æ¯ä¸€è¡Œè½¬æ¢ä¸ºå“ˆå¸Œå€¼ï¼Œç”¨äºå¿«é€Ÿæ¯”è¾ƒ
     * @param {ImageData} imageData - Canvas ImageData å¯¹è±¡
     * @param {number} ignoreRightPixels - å¿½ç•¥å³ä¾§å¤šå°‘åƒç´ 
     * @returns {Array<number>} è¡Œå“ˆå¸Œæ•°ç»„
     */
    imageToRowHashes(imageData, ignoreRightPixels = 20) {
        const { width, height, data } = imageData;
        const rowHashes = [];
        const effectiveWidth = Math.max(0, width - ignoreRightPixels);

        // æ‰¹é‡å¤„ç†ä»¥æé«˜æ€§èƒ½
        for (let y = 0; y < height; y++) {
            const rowStart = y * width * 4;
            
            // ä½¿ç”¨æ›´é«˜æ•ˆçš„é‡‡æ ·ç­–ç•¥ - æ¯éš”å‡ ä¸ªåƒç´ é‡‡æ ·ä¸€æ¬¡
            const sampleStep = Math.max(1, Math.floor(effectiveWidth / 100)); // æœ€å¤šé‡‡æ ·100ä¸ªç‚¹
            let sumR = 0, sumG = 0, sumB = 0;
            let sampleCount = 0;

            for (let x = 0; x < effectiveWidth; x += sampleStep) {
                const pixelIndex = rowStart + x * 4;
                sumR += data[pixelIndex];     // R
                sumG += data[pixelIndex + 1]; // G
                sumB += data[pixelIndex + 2]; // B
                sampleCount++;
            }

            if (sampleCount > 0) {
                // è®¡ç®—å¹³å‡å€¼å¹¶é‡åŒ–ä»¥æé«˜å®¹å¿åº¦
                const avgR = Math.floor((sumR / sampleCount) / 16) * 16; // å¢å¤§é‡åŒ–æ­¥é•¿
                const avgG = Math.floor((sumG / sampleCount) / 16) * 16;
                const avgB = Math.floor((sumB / sampleCount) / 16) * 16;
                
                // æ›´é«˜æ•ˆçš„å“ˆå¸Œå‡½æ•°
                const hash = (avgR << 16) | (avgG << 8) | avgB;
                rowHashes.push(hash);
            } else {
                rowHashes.push(0);
            }
        }

        return rowHashes;
    }

    /**
     * æ‰¾åˆ°ä¸¤ä¸ªåºåˆ—çš„æœ€é•¿å…¬å…±å­ä¸²
     * @param {Array<number>} seq1 - ç¬¬ä¸€ä¸ªåºåˆ—
     * @param {Array<number>} seq2 - ç¬¬äºŒä¸ªåºåˆ—
     * @param {number} minRatio - æœ€å°é‡å æ¯”ä¾‹é˜ˆå€¼
     * @returns {Object} {seq1Start, seq2Start, length}
     */
    findLongestCommonSubstring(seq1, seq2, minRatio = 0.01) {
        const m = seq1.length;
        const n = seq2.length;
        const minLength = Math.floor(Math.min(m, n) * minRatio);

        // åŠ¨æ€è§„åˆ’è¡¨
        const dp = Array(m + 1).fill(0).map(() => Array(n + 1).fill(0));

        let maxLength = 0;
        let endingPosI = 0;
        let endingPosJ = 0;

        for (let i = 1; i <= m; i++) {
            for (let j = 1; j <= n; j++) {
                if (seq1[i - 1] === seq2[j - 1]) {
                    dp[i][j] = dp[i - 1][j - 1] + 1;
                    if (dp[i][j] > maxLength) {
                        maxLength = dp[i][j];
                        endingPosI = i;
                        endingPosJ = j;
                    }
                } else {
                    dp[i][j] = 0;
                }
            }
        }

        if (maxLength < minLength) {
            return { seq1Start: -1, seq2Start: -1, length: 0 };
        }

        const seq1Start = endingPosI - maxLength;
        const seq2Start = endingPosJ - maxLength;

        return { seq1Start, seq2Start, length: maxLength };
    }

    /**
     * å¯»æ‰¾æœ€ä½³é‡å åŒºåŸŸ
     * @param {Array<number>} img1Hashes - ç¬¬ä¸€å¼ å›¾ç‰‡çš„è¡Œå“ˆå¸Œ
     * @param {Array<number>} img2Hashes - ç¬¬äºŒå¼ å›¾ç‰‡çš„è¡Œå“ˆå¸Œ
     * @returns {Object} é‡å ä¿¡æ¯
     */
    findBestOverlap(img1Hashes, img2Hashes) {
        console.log(`æœç´¢é‡å åŒºåŸŸ: img1æœ‰${img1Hashes.length}è¡Œ, img2æœ‰${img2Hashes.length}è¡Œ`);

        const overlap = this.findLongestCommonSubstring(img1Hashes, img2Hashes, 0.01);

        if (overlap.length > 0) {
            const overlapRatio = overlap.length / Math.min(img1Hashes.length, img2Hashes.length);
            console.log(`æ‰¾åˆ°é‡å : é•¿åº¦${overlap.length}è¡Œ, å æ¯”${(overlapRatio * 100).toFixed(2)}%`);
            return overlap;
        } else {
            console.log("æœªæ‰¾åˆ°ä»»ä½•é‡å åŒºåŸŸ");
            return { seq1Start: -1, seq2Start: -1, length: 0 };
        }
    }

    /**
     * å°†å›¾ç‰‡ç»˜åˆ¶åˆ° Canvas å¹¶è·å– ImageData
     * @param {HTMLImageElement} img - å›¾ç‰‡å…ƒç´ 
     * @returns {Object} {canvas, ctx, imageData}
     */
    imageToImageData(img) {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d', {
            alpha: false,  // ç¦ç”¨ alpha é€šé“ä»¥æé«˜æ€§èƒ½
            desynchronized: true  // å¯ç”¨å¼‚æ­¥æ¸²æŸ“
        });
        
        canvas.width = img.width;
        canvas.height = img.height;
        
        // ä½¿ç”¨é«˜è´¨é‡å›¾åƒå¹³æ»‘ç®—æ³•
        ctx.imageSmoothingEnabled = true;
        ctx.imageSmoothingQuality = 'high';
        
        ctx.drawImage(img, 0, 0);
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        
        return { canvas, ctx, imageData };
    }

    /**
     * æ‹¼æ¥ä¸¤å¼ å›¾ç‰‡
     * @param {HTMLImageElement} img1 - ç¬¬ä¸€å¼ å›¾ç‰‡
     * @param {HTMLImageElement} img2 - ç¬¬äºŒå¼ å›¾ç‰‡
     * @returns {Promise<HTMLCanvasElement>} æ‹¼æ¥ç»“æœçš„ Canvas
     */
    async stitchImages(img1, img2) {
        console.log(`å¤„ç†å›¾ç‰‡: ${img1.width}x${img1.height} + ${img2.width}x${img2.height}`);

        // ç¡®ä¿ä¸¤å¼ å›¾ç‰‡å®½åº¦ç›¸åŒ
        let processedImg1 = img1;
        if (img1.width !== img2.width) {
            console.log(`è°ƒæ•´å›¾ç‰‡å®½åº¦: ${img1.width} -> ${img2.width}`);
            processedImg1 = await this.resizeImage(img1, img2.width, Math.floor(img1.height * img2.width / img1.width));
        }

        // è·å–å›¾ç‰‡æ•°æ®
        const img1Data = this.imageToImageData(processedImg1);
        const img2Data = this.imageToImageData(img2);

        console.log(`å¿½ç•¥å³ä¾§ ${this.ignoreRightPixels} åƒç´ æ¥æ’é™¤æ»šåŠ¨æ¡å½±å“`);
        
        // è½¬æ¢ä¸ºè¡Œå“ˆå¸Œ
        const img1Hashes = this.imageToRowHashes(img1Data.imageData, this.ignoreRightPixels);
        const img2Hashes = this.imageToRowHashes(img2Data.imageData, this.ignoreRightPixels);

        // å¯»æ‰¾é‡å åŒºåŸŸ
        const overlap = this.findBestOverlap(img1Hashes, img2Hashes);

        // åˆ›å»ºç»“æœ Canvasï¼Œä¼˜åŒ–è®¾ç½®
        const resultCanvas = document.createElement('canvas');
        const resultCtx = resultCanvas.getContext('2d', {
            alpha: false,
            desynchronized: true
        });

        if (overlap.length === 0) {
            console.log("æœªæ‰¾åˆ°é‡å åŒºåŸŸï¼Œç›´æ¥æ‹¼æ¥");
            // ç›´æ¥æ‹¼æ¥
            resultCanvas.width = img2.width;
            resultCanvas.height = processedImg1.height + img2.height;
            
            resultCtx.drawImage(processedImg1, 0, 0);
            resultCtx.drawImage(img2, 0, processedImg1.height);
        } else {
            const { seq1Start: img1Start, seq2Start: img2Start, length: overlapLength } = overlap;
            console.log(`æ‰¾åˆ°é‡å åŒºåŸŸ: img1[${img1Start}:${img1Start + overlapLength}] = img2[${img2Start}:${img2Start + overlapLength}]`);

            // è®¡ç®—æ‹¼æ¥åçš„æ€»é«˜åº¦
            const img1KeepHeight = img1Start + overlapLength;
            const img2SkipHeight = img2Start + overlapLength;
            const img2KeepHeight = img2.height - img2SkipHeight;
            const resultHeight = img1KeepHeight + img2KeepHeight;

            console.log(`æ‹¼æ¥è®¡ç®—: img1ä¿ç•™${img1KeepHeight}è¡Œ + img2è·³è¿‡${img2SkipHeight}è¡Œä¿ç•™${img2KeepHeight}è¡Œ = æ€»è®¡${resultHeight}è¡Œ`);

            resultCanvas.width = img2.width;
            resultCanvas.height = resultHeight;

            // ç»˜åˆ¶img1çš„ä¿ç•™éƒ¨åˆ†
            resultCtx.drawImage(
                processedImg1,
                0, 0, processedImg1.width, img1KeepHeight,
                0, 0, processedImg1.width, img1KeepHeight
            );

            // ç»˜åˆ¶img2çš„å‰©ä½™éƒ¨åˆ†
            if (img2KeepHeight > 0) {
                resultCtx.drawImage(
                    img2,
                    0, img2SkipHeight, img2.width, img2KeepHeight,
                    0, img1KeepHeight, img2.width, img2KeepHeight
                );
            }
        }

        return resultCanvas;
    }

    /**
     * è°ƒæ•´å›¾ç‰‡å°ºå¯¸
     * @param {HTMLImageElement} img - åŸå›¾ç‰‡
     * @param {number} newWidth - æ–°å®½åº¦
     * @param {number} newHeight - æ–°é«˜åº¦
     * @returns {Promise<HTMLImageElement>} è°ƒæ•´åçš„å›¾ç‰‡
     */
    async resizeImage(img, newWidth, newHeight) {
        return new Promise((resolve) => {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = newWidth;
            canvas.height = newHeight;
            
            ctx.drawImage(img, 0, 0, newWidth, newHeight);
            
            const resizedImg = new Image();
            resizedImg.onload = () => resolve(resizedImg);
            resizedImg.src = canvas.toDataURL();
        });
    }

    /**
     * æ‹¼æ¥å¤šå¼ å›¾ç‰‡
     * @param {Array<File>} imageFiles - å›¾ç‰‡æ–‡ä»¶æ•°ç»„
     * @param {Function} progressCallback - è¿›åº¦å›è°ƒå‡½æ•°
     * @returns {Promise<HTMLCanvasElement>} æ‹¼æ¥ç»“æœçš„ Canvas
     */
    async stitchMultipleImages(imageFiles, progressCallback = null) {
        if (imageFiles.length < 2) {
            throw new Error("è‡³å°‘éœ€è¦ä¸¤å¼ å›¾ç‰‡è¿›è¡Œæ‹¼æ¥");
        }

        console.log(`å¼€å§‹æ‹¼æ¥ ${imageFiles.length} å¼ å›¾ç‰‡...`);

        // æµå¼å¤„ç†å›¾ç‰‡ï¼Œé¿å…åŒæ—¶åŠ è½½æ‰€æœ‰å›¾ç‰‡å ç”¨è¿‡å¤šå†…å­˜
        let result = await this.loadImage(imageFiles[0]);
        console.log(`åŸºç¡€å›¾ç‰‡: ${result.width}x${result.height}`);

        if (progressCallback) {
            progressCallback({
                stage: 'loading',
                current: 1,
                total: imageFiles.length
            });
        }

        for (let i = 1; i < imageFiles.length; i++) {
            console.log(`\nå¤„ç†ç¬¬ ${i + 1} å¼ å›¾ç‰‡`);
            
            // é€ä¸ªåŠ è½½å›¾ç‰‡ï¼Œå¤„ç†å®Œç«‹å³é‡Šæ”¾
            const nextImg = await this.loadImage(imageFiles[i]);
            
            if (progressCallback) {
                progressCallback({
                    stage: 'loading',
                    current: i + 1,
                    total: imageFiles.length
                });
            }

            // å¦‚æœ result æ˜¯ Canvasï¼Œéœ€è¦è½¬æ¢ä¸º Image
            if (result instanceof HTMLCanvasElement) {
                const tempImg = await this.canvasToImage(result);
                result = tempImg;
            }

            // æ‰§è¡Œæ‹¼æ¥
            const newResult = await this.stitchImages(result, nextImg);
            
            // é‡Šæ”¾ä¹‹å‰çš„ç»“æœä»¥èŠ‚çœå†…å­˜
            if (result instanceof HTMLImageElement && result.src.startsWith('blob:')) {
                URL.revokeObjectURL(result.src);
            }
            
            result = newResult;
            console.log(`å½“å‰ç»“æœå°ºå¯¸: ${result.width}x${result.height}`);

            if (progressCallback) {
                progressCallback({
                    stage: 'stitching',
                    current: i,
                    total: imageFiles.length - 1
                });
            }

            // å¼ºåˆ¶åƒåœ¾å›æ”¶ (å¦‚æœæµè§ˆå™¨æ”¯æŒ)
            if (window.gc) {
                window.gc();
            }
        }

        console.log(`æ‹¼æ¥å®Œæˆ! æœ€ç»ˆå°ºå¯¸: ${result.width}x${result.height}`);
        return result;
    }

    /**
     * å°† Canvas è½¬æ¢ä¸º Image
     * @param {HTMLCanvasElement} canvas - Canvas å…ƒç´ 
     * @returns {Promise<HTMLImageElement>} è½¬æ¢åçš„å›¾ç‰‡
     */
    async canvasToImage(canvas) {
        return new Promise((resolve) => {
            const img = new Image();
            img.onload = () => resolve(img);
            img.src = canvas.toDataURL('image/jpeg', 0.9); // ä½¿ç”¨ JPEG å‹ç¼©ä»¥èŠ‚çœå†…å­˜
        });
    }

    /**
     * ä»æ–‡ä»¶åŠ è½½å›¾ç‰‡
     * @param {File} file - å›¾ç‰‡æ–‡ä»¶
     * @returns {Promise<HTMLImageElement>} åŠ è½½çš„å›¾ç‰‡
     */
    loadImage(file) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            const url = URL.createObjectURL(file);
            
            img.onload = () => {
                URL.revokeObjectURL(url);
                resolve(img);
            };
            
            img.onerror = () => {
                URL.revokeObjectURL(url);
                reject(new Error(`æ— æ³•åŠ è½½å›¾ç‰‡: ${file.name}`));
            };
            
            img.src = url;
        });
    }

    /**
     * è®¾ç½®å¿½ç•¥å³ä¾§åƒç´ æ•°é‡
     * @param {number} pixels - åƒç´ æ•°é‡
     */
    setIgnoreRightPixels(pixels) {
        this.ignoreRightPixels = Math.max(0, pixels);
    }
}

// å¯¼å‡ºç±»ä¾›å…¶ä»–è„šæœ¬ä½¿ç”¨
if (typeof module !== 'undefined' && module.exports) {
    module.exports = LongScreenshotStitcher;
}

```

ç°åœ¨è®©æˆ‘æ·»åŠ ä¸€äº› UI æ€§èƒ½ä¼˜åŒ–å’Œç”¨æˆ·ä½“éªŒæ”¹è¿›åˆ° HTML æ–‡ä»¶ï¼š

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 300;
            color: #34495e;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 12px;
            padding: 60px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }

        .upload-area.dragover {
            border-color: #2980b9;
            background: #e8f4fd;
        }

        .upload-icon {
            font-size: 3em;
            color: #bdc3c7;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 10px;
        }

        .upload-hint {
            font-size: 0.9em;
            color: #95a5a6;
        }

        .file-input {
            display: none;
        }

        .settings {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .settings h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .setting-item label {
            color: #34495e;
            font-weight: 500;
        }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .file-list h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
        }

        .file-item:last-child {
            border-bottom: none;
        }

        .file-info {
            display: flex;
            align-items: center;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

        .file-details {
            display: flex;
            flex-direction: column;
        }

        .file-name {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 2px;
        }

        .file-size {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s ease;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .progress {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .result {
            background: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .result-image:hover {
            transform: scale(1.02);
        }

        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            cursor: pointer;
        }

        .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 8px;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1001;
        }

        .empty-state {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 20px 0;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .upload-area {
                padding: 40px 15px;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
            <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
        </div>

        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">ğŸ“</div>
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>

        <div class="settings">
            <h3>è®¾ç½®</h3>
            <div class="setting-item">
                <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
                <input type="number" id="ignorePixels" value="20" min="0" max="100">
            </div>
        </div>

        <div class="file-list" id="fileList">
            <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
            <div id="fileItems">
                <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-primary" id="stitchBtn" disabled>
                ğŸ”— å¼€å§‹æ‹¼æ¥
            </button>
            <button class="btn btn-secondary" id="clearBtn" disabled>
                ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
            </button>
        </div>

        <div class="progress" id="progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
        </div>

        <div class="result" id="result">
            <h3>æ‹¼æ¥ç»“æœ</h3>
            <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ">
            <div>
                <button class="btn btn-primary" id="downloadBtn">
                    ğŸ’¾ ä¸‹è½½å›¾ç‰‡
                </button>
            </div>
        </div>
    </div>

    <script src="longshot.js"></script>
    <script>
        class LongShotApp {
            constructor() {
                this.stitcher = new LongScreenshotStitcher();
                this.selectedFiles = [];
                this.resultCanvas = null;
                
                this.initializeElements();
                this.bindEvents();
            }

            initializeElements() {
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.fileList = document.getElementById('fileList');
                this.fileItems = document.getElementById('fileItems');
                this.fileCount = document.getElementById('fileCount');
                this.stitchBtn = document.getElementById('stitchBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.progress = document.getElementById('progress');
                this.progressFill = document.getElementById('progressFill');
                this.progressText = document.getElementById('progressText');
                this.result = document.getElementById('result');
                this.resultImage = document.getElementById('resultImage');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.ignorePixels = document.getElementById('ignorePixels');
            }

            bindEvents() {
                // æ–‡ä»¶é€‰æ‹©
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

                // æ‹–æ‹½ä¸Šä¼ 
                this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
                this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
                this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

                // æŒ‰é’®äº‹ä»¶
                this.stitchBtn.addEventListener('click', () => this.startStitching());
                this.clearBtn.addEventListener('click', () => this.clearFiles());
                this.downloadBtn.addEventListener('click', () => this.downloadResult());

                // è®¾ç½®å˜æ›´
                this.ignorePixels.addEventListener('change', () => {
                    this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
                });
            }

            handleFileSelect(e) {
                const files = Array.from(e.target.files);
                this.addFiles(files);
            }

            handleDragOver(e) {
                e.preventDefault();
                this.uploadArea.classList.add('dragover');
            }

            handleDragLeave(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
            }

            handleDrop(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
                
                const files = Array.from(e.dataTransfer.files).filter(file => 
                    file.type.startsWith('image/')
                );
                this.addFiles(files);
            }

            addFiles(files) {
                const validFiles = files.filter(file => file.type.startsWith('image/'));
                this.selectedFiles.push(...validFiles);
                this.updateFileList();
                this.updateButtons();
            }

            updateFileList() {
                this.fileCount.textContent = this.selectedFiles.length;
                
                if (this.selectedFiles.length === 0) {
                    this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
                    return;
                }

                this.fileItems.innerHTML = '';
                this.selectedFiles.forEach((file, index) => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;
                    
                    this.fileItems.appendChild(fileItem);
                });
            }

            removeFile(index) {
                this.selectedFiles.splice(index, 1);
                this.updateFileList();
                this.updateButtons();
            }

            clearFiles() {
                this.selectedFiles = [];
                this.fileInput.value = '';
                this.updateFileList();
                this.updateButtons();
                this.hideResult();
            }

            updateButtons() {
                const hasEnoughFiles = this.selectedFiles.length >= 2;
                this.stitchBtn.disabled = !hasEnoughFiles;
                this.clearBtn.disabled = this.selectedFiles.length === 0;
            }

            async startStitching() {
                if (this.selectedFiles.length < 2) {
                    alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
                    return;
                }

                this.showProgress();
                this.hideResult();
                this.stitchBtn.disabled = true;

                try {
                    this.resultCanvas = await this.stitcher.stitchMultipleImages(
                        this.selectedFiles,
                        (progress) => this.updateProgress(progress)
                    );

                    this.showResult();
                } catch (error) {
                    console.error('æ‹¼æ¥å¤±è´¥:', error);
                    alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
                } finally {
                    this.hideProgress();
                    this.stitchBtn.disabled = false;
                }
            }

            updateProgress(progress) {
                let percentage, text;
                
                if (progress.stage === 'loading') {
                    percentage = (progress.current / progress.total) * 50;
                    text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
                } else if (progress.stage === 'stitching') {
                    percentage = 50 + (progress.current / progress.total) * 50;
                    text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
                }
                
                this.progressFill.style.width = `${percentage}%`;
                this.progressText.textContent = text;
            }

            showProgress() {
                this.progress.style.display = 'block';
                this.progressFill.style.width = '0%';
                this.progressText.textContent = 'å‡†å¤‡ä¸­...';
            }

            hideProgress() {
                this.progress.style.display = 'none';
            }

            showResult() {
                if (this.resultCanvas) {
                    this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                    this.result.style.display = 'block';
                    
                    // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                    this.result.scrollIntoView({ behavior: 'smooth' });
                }
            }

            hideResult() {
                this.result.style.display = 'none';
            }

            downloadResult() {
                if (!this.resultCanvas) return;

                const link = document.createElement('a');
                link.download = `longshot-result-${new Date().getTime()}.jpg`;
                link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                link.click();
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        const app = new LongShotApp();
    </script>
</body>
</html>

```

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 300;
            color: #34495e;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 12px;
            padding: 60px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }

        .upload-area.dragover {
            border-color: #2980b9;
            background: #e8f4fd;
        }

        .upload-icon {
            font-size: 3em;
            color: #bdc3c7;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 10px;
        }

        .upload-hint {
            font-size: 0.9em;
            color: #95a5a6;
        }

        .file-input {
            display: none;
        }

        .settings {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .settings h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .setting-item label {
            color: #34495e;
            font-weight: 500;
        }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .file-list h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
        }

        .file-item:last-child {
            border-bottom: none;
        }

        .file-info {
            display: flex;
            align-items: center;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

        .file-details {
            display: flex;
            flex-direction: column;
        }

        .file-name {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 2px;
        }

        .file-size {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s ease;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .progress {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .result {
            background: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .result-image:hover {
            transform: scale(1.02);
        }

        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            cursor: pointer;
        }

        .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 8px;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1001;
        }

        .empty-state {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 20px 0;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .upload-area {
                padding: 40px 15px;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
            <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
        </div>

        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">ğŸ“</div>
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>

        <div class="settings">
            <h3>è®¾ç½®</h3>
            <div class="setting-item">
                <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
                <input type="number" id="ignorePixels" value="20" min="0" max="100">
            </div>
        </div>

        <div class="file-list" id="fileList">
            <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
            <div id="fileItems">
                <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-primary" id="stitchBtn" disabled>
                ğŸ”— å¼€å§‹æ‹¼æ¥
            </button>
            <button class="btn btn-secondary" id="clearBtn" disabled>
                ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
            </button>
        </div>

        <div class="progress" id="progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
        </div>

        <div class="result" id="result">
            <h3>æ‹¼æ¥ç»“æœ</h3>
            <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
            <div>
                <button class="btn btn-primary" id="downloadBtn">
                    ğŸ’¾ ä¸‹è½½å›¾ç‰‡
                </button>
            </div>
        </div>

        <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
        <div class="image-modal" id="imageModal">
            <span class="modal-close">&times;</span>
            <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
        </div>
    </div>

    <script src="longshot.js"></script>
    <script>
        class LongShotApp {
            constructor() {
                this.stitcher = new LongScreenshotStitcher();
                this.selectedFiles = [];
                this.resultCanvas = null;
                
                this.initializeElements();
                this.bindEvents();
            }

            initializeElements() {
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.fileList = document.getElementById('fileList');
                this.fileItems = document.getElementById('fileItems');
                this.fileCount = document.getElementById('fileCount');
                this.stitchBtn = document.getElementById('stitchBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.progress = document.getElementById('progress');
                this.progressFill = document.getElementById('progressFill');
                this.progressText = document.getElementById('progressText');
                this.result = document.getElementById('result');
                this.resultImage = document.getElementById('resultImage');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.ignorePixels = document.getElementById('ignorePixels');
            }

            bindEvents() {
                // æ–‡ä»¶é€‰æ‹©
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

                // æ‹–æ‹½ä¸Šä¼ 
                this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
                this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
                this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

                // æŒ‰é’®äº‹ä»¶
                this.stitchBtn.addEventListener('click', () => this.startStitching());
                this.clearBtn.addEventListener('click', () => this.clearFiles());
                this.downloadBtn.addEventListener('click', () => this.downloadResult());

                // è®¾ç½®å˜æ›´
                this.ignorePixels.addEventListener('change', () => {
                    this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
                });
            }

            handleFileSelect(e) {
                const files = Array.from(e.target.files);
                this.addFiles(files);
            }

            handleDragOver(e) {
                e.preventDefault();
                this.uploadArea.classList.add('dragover');
            }

            handleDragLeave(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
            }

            handleDrop(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
                
                const files = Array.from(e.dataTransfer.files).filter(file => 
                    file.type.startsWith('image/')
                );
                this.addFiles(files);
            }

            addFiles(files) {
                const validFiles = files.filter(file => file.type.startsWith('image/'));
                this.selectedFiles.push(...validFiles);
                this.updateFileList();
                this.updateButtons();
            }

            updateFileList() {
                this.fileCount.textContent = this.selectedFiles.length;
                
                if (this.selectedFiles.length === 0) {
                    this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
                    return;
                }

                this.fileItems.innerHTML = '';
                this.selectedFiles.forEach((file, index) => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;
                    
                    this.fileItems.appendChild(fileItem);
                });
            }

            removeFile(index) {
                this.selectedFiles.splice(index, 1);
                this.updateFileList();
                this.updateButtons();
            }

            clearFiles() {
                this.selectedFiles = [];
                this.fileInput.value = '';
                this.updateFileList();
                this.updateButtons();
                this.hideResult();
            }

            updateButtons() {
                const hasEnoughFiles = this.selectedFiles.length >= 2;
                this.stitchBtn.disabled = !hasEnoughFiles;
                this.clearBtn.disabled = this.selectedFiles.length === 0;
            }

            async startStitching() {
                if (this.selectedFiles.length < 2) {
                    alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
                    return;
                }

                this.showProgress();
                this.hideResult();
                this.stitchBtn.disabled = true;

                try {
                    this.resultCanvas = await this.stitcher.stitchMultipleImages(
                        this.selectedFiles,
                        (progress) => this.updateProgress(progress)
                    );

                    this.showResult();
                } catch (error) {
                    console.error('æ‹¼æ¥å¤±è´¥:', error);
                    alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
                } finally {
                    this.hideProgress();
                    this.stitchBtn.disabled = false;
                }
            }

            updateProgress(progress) {
                let percentage, text;
                
                if (progress.stage === 'loading') {
                    percentage = (progress.current / progress.total) * 50;
                    text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
                } else if (progress.stage === 'stitching') {
                    percentage = 50 + (progress.current / progress.total) * 50;
                    text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
                }
                
                this.progressFill.style.width = `${percentage}%`;
                this.progressText.textContent = text;
            }

            showProgress() {
                this.progress.style.display = 'block';
                this.progressFill.style.width = '0%';
                this.progressText.textContent = 'å‡†å¤‡ä¸­...';
            }

            hideProgress() {
                this.progress.style.display = 'none';
            }

            showResult() {
                if (this.resultCanvas) {
                    this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                    this.result.style.display = 'block';
                    
                    // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                    this.result.scrollIntoView({ behavior: 'smooth' });
                }
            }

            hideResult() {
                this.result.style.display = 'none';
            }

            downloadResult() {
                if (!this.resultCanvas) return;

                const link = document.createElement('a');
                link.download = `longshot-result-${new Date().getTime()}.jpg`;
                link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                link.click();
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        const app = new LongShotApp();
    </script>
</body>
</html>

```

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 300;
            color: #34495e;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 12px;
            padding: 60px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }

        .upload-area.dragover {
            border-color: #2980b9;
            background: #e8f4fd;
        }

        .upload-icon {
            font-size: 3em;
            color: #bdc3c7;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 10px;
        }

        .upload-hint {
            font-size: 0.9em;
            color: #95a5a6;
        }

        .file-input {
            display: none;
        }

        .settings {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .settings h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .setting-item label {
            color: #34495e;
            font-weight: 500;
        }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .file-list h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
        }

        .file-item:last-child {
            border-bottom: none;
        }

        .file-info {
            display: flex;
            align-items: center;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

        .file-details {
            display: flex;
            flex-direction: column;
        }

        .file-name {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 2px;
        }

        .file-size {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s ease;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .progress {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .result {
            background: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .result-image:hover {
            transform: scale(1.02);
        }

        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            cursor: pointer;
        }

        .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 8px;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1001;
        }

        .empty-state {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 20px 0;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .upload-area {
                padding: 40px 15px;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
            <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
        </div>

        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">ğŸ“</div>
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>

        <div class="settings">
            <h3>è®¾ç½®</h3>
            <div class="setting-item">
                <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
                <input type="number" id="ignorePixels" value="20" min="0" max="100">
            </div>
        </div>

        <div class="file-list" id="fileList">
            <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
            <div id="fileItems">
                <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-primary" id="stitchBtn" disabled>
                ğŸ”— å¼€å§‹æ‹¼æ¥
            </button>
            <button class="btn btn-secondary" id="clearBtn" disabled>
                ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
            </button>
        </div>

        <div class="progress" id="progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
        </div>

        <div class="result" id="result">
            <h3>æ‹¼æ¥ç»“æœ</h3>
            <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
            <div>
                <button class="btn btn-primary" id="downloadBtn">
                    ğŸ’¾ ä¸‹è½½å›¾ç‰‡
                </button>
            </div>
        </div>

        <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
        <div class="image-modal" id="imageModal">
            <span class="modal-close">&times;</span>
            <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
        </div>
    </div>

    <script src="longshot.js"></script>
    <script>
        class LongShotApp {
            constructor() {
                this.stitcher = new LongScreenshotStitcher();
                this.selectedFiles = [];
                this.resultCanvas = null;
                
                this.initializeElements();
                this.bindEvents();
            }

            initializeElements() {
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.fileList = document.getElementById('fileList');
                this.fileItems = document.getElementById('fileItems');
                this.fileCount = document.getElementById('fileCount');
                this.stitchBtn = document.getElementById('stitchBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.progress = document.getElementById('progress');
                this.progressFill = document.getElementById('progressFill');
                this.progressText = document.getElementById('progressText');
                this.result = document.getElementById('result');
                this.resultImage = document.getElementById('resultImage');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.ignorePixels = document.getElementById('ignorePixels');
                this.imageModal = document.getElementById('imageModal');
                this.modalImage = document.getElementById('modalImage');
            }

            bindEvents() {
                // æ–‡ä»¶é€‰æ‹©
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

                // æ‹–æ‹½ä¸Šä¼ 
                this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
                this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
                this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

                // æŒ‰é’®äº‹ä»¶
                this.stitchBtn.addEventListener('click', () => this.startStitching());
                this.clearBtn.addEventListener('click', () => this.clearFiles());
                this.downloadBtn.addEventListener('click', () => this.downloadResult());

                // è®¾ç½®å˜æ›´
                this.ignorePixels.addEventListener('change', () => {
                    this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
                });
            }

            handleFileSelect(e) {
                const files = Array.from(e.target.files);
                this.addFiles(files);
            }

            handleDragOver(e) {
                e.preventDefault();
                this.uploadArea.classList.add('dragover');
            }

            handleDragLeave(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
            }

            handleDrop(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
                
                const files = Array.from(e.dataTransfer.files).filter(file => 
                    file.type.startsWith('image/')
                );
                this.addFiles(files);
            }

            addFiles(files) {
                const validFiles = files.filter(file => file.type.startsWith('image/'));
                this.selectedFiles.push(...validFiles);
                this.updateFileList();
                this.updateButtons();
            }

            updateFileList() {
                this.fileCount.textContent = this.selectedFiles.length;
                
                if (this.selectedFiles.length === 0) {
                    this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
                    return;
                }

                this.fileItems.innerHTML = '';
                this.selectedFiles.forEach((file, index) => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;
                    
                    this.fileItems.appendChild(fileItem);
                });
            }

            removeFile(index) {
                this.selectedFiles.splice(index, 1);
                this.updateFileList();
                this.updateButtons();
            }

            clearFiles() {
                this.selectedFiles = [];
                this.fileInput.value = '';
                this.updateFileList();
                this.updateButtons();
                this.hideResult();
            }

            updateButtons() {
                const hasEnoughFiles = this.selectedFiles.length >= 2;
                this.stitchBtn.disabled = !hasEnoughFiles;
                this.clearBtn.disabled = this.selectedFiles.length === 0;
            }

            async startStitching() {
                if (this.selectedFiles.length < 2) {
                    alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
                    return;
                }

                this.showProgress();
                this.hideResult();
                this.stitchBtn.disabled = true;

                try {
                    this.resultCanvas = await this.stitcher.stitchMultipleImages(
                        this.selectedFiles,
                        (progress) => this.updateProgress(progress)
                    );

                    this.showResult();
                } catch (error) {
                    console.error('æ‹¼æ¥å¤±è´¥:', error);
                    alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
                } finally {
                    this.hideProgress();
                    this.stitchBtn.disabled = false;
                }
            }

            updateProgress(progress) {
                let percentage, text;
                
                if (progress.stage === 'loading') {
                    percentage = (progress.current / progress.total) * 50;
                    text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
                } else if (progress.stage === 'stitching') {
                    percentage = 50 + (progress.current / progress.total) * 50;
                    text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
                }
                
                this.progressFill.style.width = `${percentage}%`;
                this.progressText.textContent = text;
            }

            showProgress() {
                this.progress.style.display = 'block';
                this.progressFill.style.width = '0%';
                this.progressText.textContent = 'å‡†å¤‡ä¸­...';
            }

            hideProgress() {
                this.progress.style.display = 'none';
            }

            showResult() {
                if (this.resultCanvas) {
                    this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                    this.result.style.display = 'block';
                    
                    // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                    this.result.scrollIntoView({ behavior: 'smooth' });
                }
            }

            hideResult() {
                this.result.style.display = 'none';
            }

            downloadResult() {
                if (!this.resultCanvas) return;

                const link = document.createElement('a');
                link.download = `longshot-result-${new Date().getTime()}.jpg`;
                link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                link.click();
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        const app = new LongShotApp();
    </script>
</body>
</html>

```

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 300;
            color: #34495e;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 12px;
            padding: 60px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }

        .upload-area.dragover {
            border-color: #2980b9;
            background: #e8f4fd;
        }

        .upload-icon {
            font-size: 3em;
            color: #bdc3c7;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 10px;
        }

        .upload-hint {
            font-size: 0.9em;
            color: #95a5a6;
        }

        .file-input {
            display: none;
        }

        .settings {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .settings h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .setting-item label {
            color: #34495e;
            font-weight: 500;
        }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .file-list h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
        }

        .file-item:last-child {
            border-bottom: none;
        }

        .file-info {
            display: flex;
            align-items: center;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

        .file-details {
            display: flex;
            flex-direction: column;
        }

        .file-name {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 2px;
        }

        .file-size {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s ease;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .progress {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .result {
            background: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .result-image:hover {
            transform: scale(1.02);
        }

        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            cursor: pointer;
        }

        .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 8px;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1001;
        }

        .empty-state {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 20px 0;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .upload-area {
                padding: 40px 15px;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
            <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
        </div>

        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">ğŸ“</div>
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>

        <div class="settings">
            <h3>è®¾ç½®</h3>
            <div class="setting-item">
                <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
                <input type="number" id="ignorePixels" value="20" min="0" max="100">
            </div>
        </div>

        <div class="file-list" id="fileList">
            <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
            <div id="fileItems">
                <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-primary" id="stitchBtn" disabled>
                ğŸ”— å¼€å§‹æ‹¼æ¥
            </button>
            <button class="btn btn-secondary" id="clearBtn" disabled>
                ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
            </button>
        </div>

        <div class="progress" id="progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
        </div>

        <div class="result" id="result">
            <h3>æ‹¼æ¥ç»“æœ</h3>
            <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
            <div>
                <button class="btn btn-primary" id="downloadBtn">
                    ğŸ’¾ ä¸‹è½½å›¾ç‰‡
                </button>
            </div>
        </div>

        <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
        <div class="image-modal" id="imageModal">
            <span class="modal-close">&times;</span>
            <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
        </div>
    </div>

    <script src="longshot.js"></script>
    <script>
        class LongShotApp {
            constructor() {
                this.stitcher = new LongScreenshotStitcher();
                this.selectedFiles = [];
                this.resultCanvas = null;
                
                this.initializeElements();
                this.bindEvents();
            }

            initializeElements() {
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.fileList = document.getElementById('fileList');
                this.fileItems = document.getElementById('fileItems');
                this.fileCount = document.getElementById('fileCount');
                this.stitchBtn = document.getElementById('stitchBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.progress = document.getElementById('progress');
                this.progressFill = document.getElementById('progressFill');
                this.progressText = document.getElementById('progressText');
                this.result = document.getElementById('result');
                this.resultImage = document.getElementById('resultImage');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.ignorePixels = document.getElementById('ignorePixels');
                this.imageModal = document.getElementById('imageModal');
                this.modalImage = document.getElementById('modalImage');
            }

            bindEvents() {
                // æ–‡ä»¶é€‰æ‹©
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

                // æ‹–æ‹½ä¸Šä¼ 
                this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
                this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
                this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

                // æŒ‰é’®äº‹ä»¶
                this.stitchBtn.addEventListener('click', () => this.startStitching());
                this.clearBtn.addEventListener('click', () => this.clearFiles());
                this.downloadBtn.addEventListener('click', () => this.downloadResult());

                // è®¾ç½®å˜æ›´
                this.ignorePixels.addEventListener('change', () => {
                    this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
                });

                // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
                this.resultImage.addEventListener('click', () => this.showImageModal());
                this.imageModal.addEventListener('click', () => this.hideImageModal());
                document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
            }

            handleFileSelect(e) {
                const files = Array.from(e.target.files);
                this.addFiles(files);
            }

            handleDragOver(e) {
                e.preventDefault();
                this.uploadArea.classList.add('dragover');
            }

            handleDragLeave(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
            }

            handleDrop(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
                
                const files = Array.from(e.dataTransfer.files).filter(file => 
                    file.type.startsWith('image/')
                );
                this.addFiles(files);
            }

            addFiles(files) {
                const validFiles = files.filter(file => file.type.startsWith('image/'));
                this.selectedFiles.push(...validFiles);
                this.updateFileList();
                this.updateButtons();
            }

            updateFileList() {
                this.fileCount.textContent = this.selectedFiles.length;
                
                if (this.selectedFiles.length === 0) {
                    this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
                    return;
                }

                this.fileItems.innerHTML = '';
                this.selectedFiles.forEach((file, index) => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;
                    
                    this.fileItems.appendChild(fileItem);
                });
            }

            removeFile(index) {
                this.selectedFiles.splice(index, 1);
                this.updateFileList();
                this.updateButtons();
            }

            clearFiles() {
                this.selectedFiles = [];
                this.fileInput.value = '';
                this.updateFileList();
                this.updateButtons();
                this.hideResult();
            }

            updateButtons() {
                const hasEnoughFiles = this.selectedFiles.length >= 2;
                this.stitchBtn.disabled = !hasEnoughFiles;
                this.clearBtn.disabled = this.selectedFiles.length === 0;
            }

            async startStitching() {
                if (this.selectedFiles.length < 2) {
                    alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
                    return;
                }

                this.showProgress();
                this.hideResult();
                this.stitchBtn.disabled = true;

                try {
                    this.resultCanvas = await this.stitcher.stitchMultipleImages(
                        this.selectedFiles,
                        (progress) => this.updateProgress(progress)
                    );

                    this.showResult();
                } catch (error) {
                    console.error('æ‹¼æ¥å¤±è´¥:', error);
                    alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
                } finally {
                    this.hideProgress();
                    this.stitchBtn.disabled = false;
                }
            }

            updateProgress(progress) {
                let percentage, text;
                
                if (progress.stage === 'loading') {
                    percentage = (progress.current / progress.total) * 50;
                    text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
                } else if (progress.stage === 'stitching') {
                    percentage = 50 + (progress.current / progress.total) * 50;
                    text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
                }
                
                this.progressFill.style.width = `${percentage}%`;
                this.progressText.textContent = text;
            }

            showProgress() {
                this.progress.style.display = 'block';
                this.progressFill.style.width = '0%';
                this.progressText.textContent = 'å‡†å¤‡ä¸­...';
            }

            hideProgress() {
                this.progress.style.display = 'none';
            }

            showResult() {
                if (this.resultCanvas) {
                    this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                    this.result.style.display = 'block';
                    
                    // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                    this.result.scrollIntoView({ behavior: 'smooth' });
                }
            }

            hideResult() {
                this.result.style.display = 'none';
            }

            downloadResult() {
                if (!this.resultCanvas) return;

                const link = document.createElement('a');
                link.download = `longshot-result-${new Date().getTime()}.jpg`;
                link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                link.click();
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        const app = new LongShotApp();
    </script>
</body>
</html>

```

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 300;
            color: #34495e;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 12px;
            padding: 60px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }

        .upload-area.dragover {
            border-color: #2980b9;
            background: #e8f4fd;
        }

        .upload-icon {
            font-size: 3em;
            color: #bdc3c7;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 10px;
        }

        .upload-hint {
            font-size: 0.9em;
            color: #95a5a6;
        }

        .file-input {
            display: none;
        }

        .settings {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .settings h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .setting-item label {
            color: #34495e;
            font-weight: 500;
        }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .file-list h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #ecf0f1;
        }

        .file-item:last-child {
            border-bottom: none;
        }

        .file-info {
            display: flex;
            align-items: center;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

        .file-details {
            display: flex;
            flex-direction: column;
        }

        .file-name {
            font-weight: 500;
            color: #2c3e50;
            margin-bottom: 2px;
        }

        .file-size {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s ease;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .progress {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .result {
            background: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .result-image:hover {
            transform: scale(1.02);
        }

        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            cursor: pointer;
        }

        .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 8px;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1001;
        }

        .empty-state {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 20px 0;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .upload-area {
                padding: 40px 15px;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
            <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
        </div>

        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">ğŸ“</div>
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>

        <div class="settings">
            <h3>è®¾ç½®</h3>
            <div class="setting-item">
                <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
                <input type="number" id="ignorePixels" value="20" min="0" max="100">
            </div>
        </div>

        <div class="file-list" id="fileList">
            <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
            <div id="fileItems">
                <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-primary" id="stitchBtn" disabled>
                ğŸ”— å¼€å§‹æ‹¼æ¥
            </button>
            <button class="btn btn-secondary" id="clearBtn" disabled>
                ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
            </button>
        </div>

        <div class="progress" id="progress">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
        </div>

        <div class="result" id="result">
            <h3>æ‹¼æ¥ç»“æœ</h3>
            <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
            <div>
                <button class="btn btn-primary" id="downloadBtn">
                    ğŸ’¾ ä¸‹è½½å›¾ç‰‡
                </button>
            </div>
        </div>

        <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
        <div class="image-modal" id="imageModal">
            <span class="modal-close">&times;</span>
            <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
        </div>
    </div>

    <script src="longshot.js"></script>
    <script>
        class LongShotApp {
            constructor() {
                this.stitcher = new LongScreenshotStitcher();
                this.selectedFiles = [];
                this.resultCanvas = null;
                
                this.initializeElements();
                this.bindEvents();
            }

            initializeElements() {
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.fileList = document.getElementById('fileList');
                this.fileItems = document.getElementById('fileItems');
                this.fileCount = document.getElementById('fileCount');
                this.stitchBtn = document.getElementById('stitchBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.progress = document.getElementById('progress');
                this.progressFill = document.getElementById('progressFill');
                this.progressText = document.getElementById('progressText');
                this.result = document.getElementById('result');
                this.resultImage = document.getElementById('resultImage');
                this.downloadBtn = document.getElementById('downloadBtn');
                this.ignorePixels = document.getElementById('ignorePixels');
                this.imageModal = document.getElementById('imageModal');
                this.modalImage = document.getElementById('modalImage');
            }

            bindEvents() {
                // æ–‡ä»¶é€‰æ‹©
                this.uploadArea.addEventListener('click', () => this.fileInput.click());
                this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

                // æ‹–æ‹½ä¸Šä¼ 
                this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
                this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
                this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

                // æŒ‰é’®äº‹ä»¶
                this.stitchBtn.addEventListener('click', () => this.startStitching());
                this.clearBtn.addEventListener('click', () => this.clearFiles());
                this.downloadBtn.addEventListener('click', () => this.downloadResult());

                // è®¾ç½®å˜æ›´
                this.ignorePixels.addEventListener('change', () => {
                    this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
                });

                // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
                this.resultImage.addEventListener('click', () => this.showImageModal());
                this.imageModal.addEventListener('click', () => this.hideImageModal());
                document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
            }

            handleFileSelect(e) {
                const files = Array.from(e.target.files);
                this.addFiles(files);
            }

            handleDragOver(e) {
                e.preventDefault();
                this.uploadArea.classList.add('dragover');
            }

            handleDragLeave(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
            }

            handleDrop(e) {
                e.preventDefault();
                this.uploadArea.classList.remove('dragover');
                
                const files = Array.from(e.dataTransfer.files).filter(file => 
                    file.type.startsWith('image/')
                );
                this.addFiles(files);
            }

            addFiles(files) {
                const validFiles = files.filter(file => file.type.startsWith('image/'));
                this.selectedFiles.push(...validFiles);
                this.updateFileList();
                this.updateButtons();
            }

            updateFileList() {
                this.fileCount.textContent = this.selectedFiles.length;
                
                if (this.selectedFiles.length === 0) {
                    this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
                    return;
                }

                this.fileItems.innerHTML = '';
                this.selectedFiles.forEach((file, index) => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;
                    
                    this.fileItems.appendChild(fileItem);
                });
            }

            removeFile(index) {
                this.selectedFiles.splice(index, 1);
                this.updateFileList();
                this.updateButtons();
            }

            clearFiles() {
                this.selectedFiles = [];
                this.fileInput.value = '';
                this.updateFileList();
                this.updateButtons();
                this.hideResult();
            }

            updateButtons() {
                const hasEnoughFiles = this.selectedFiles.length >= 2;
                this.stitchBtn.disabled = !hasEnoughFiles;
                this.clearBtn.disabled = this.selectedFiles.length === 0;
            }

            async startStitching() {
                if (this.selectedFiles.length < 2) {
                    alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
                    return;
                }

                this.showProgress();
                this.hideResult();
                this.stitchBtn.disabled = true;

                try {
                    this.resultCanvas = await this.stitcher.stitchMultipleImages(
                        this.selectedFiles,
                        (progress) => this.updateProgress(progress)
                    );

                    this.showResult();
                } catch (error) {
                    console.error('æ‹¼æ¥å¤±è´¥:', error);
                    alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
                } finally {
                    this.hideProgress();
                    this.stitchBtn.disabled = false;
                }
            }

            updateProgress(progress) {
                let percentage, text;
                
                if (progress.stage === 'loading') {
                    percentage = (progress.current / progress.total) * 50;
                    text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
                } else if (progress.stage === 'stitching') {
                    percentage = 50 + (progress.current / progress.total) * 50;
                    text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
                }
                
                this.progressFill.style.width = `${percentage}%`;
                this.progressText.textContent = text;
            }

            showProgress() {
                this.progress.style.display = 'block';
                this.progressFill.style.width = '0%';
                this.progressText.textContent = 'å‡†å¤‡ä¸­...';
            }

            hideProgress() {
                this.progress.style.display = 'none';
            }

            showResult() {
                if (this.resultCanvas) {
                    this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                    this.result.style.display = 'block';
                    
                    // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
                    this.result.scrollIntoView({ behavior: 'smooth' });
                }
            }

            hideResult() {
                this.result.style.display = 'none';
            }

            downloadResult() {
                if (!this.resultCanvas) return;

                const link = document.createElement('a');
                link.download = `longshot-result-${new Date().getTime()}.jpg`;
                link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                link.click();
            }

            showImageModal() {
                if (this.resultCanvas) {
                    this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
                    this.imageModal.style.display = 'block';
                    document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
                }
            }

            hideImageModal() {
                this.imageModal.style.display = 'none';
                document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        const app = new LongShotApp();
    </script>
</body>
</html>

```

ç°åœ¨å®Œæˆæœ€åçš„æ€§èƒ½ä¼˜åŒ–ä»»åŠ¡ï¼š

æœ€ååˆ›å»ºä¸€ä¸ªç®€å•çš„ README æ–‡ä»¶æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨ï¼š

```markdown
# é•¿æˆªå›¾æ‹¼æ¥å·¥å…· - Web ç‰ˆæœ¬

è¿™æ˜¯ Python ç‰ˆæœ¬ `main.py` çš„ JavaScript é‡å†™ç‰ˆæœ¬ï¼Œæä¾›çº¯å‰ç«¯çš„é•¿æˆªå›¾æ‹¼æ¥åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ–¼ï¸ **æ™ºèƒ½æ‹¼æ¥**: ä½¿ç”¨æœ€é•¿å…¬å…±å­ä¸²ç®—æ³•è‡ªåŠ¨è¯†åˆ«å›¾ç‰‡é‡å åŒºåŸŸ
- ğŸ¯ **ç²¾ç¡®å¯¹é½**: è‡ªåŠ¨å¤„ç†å›¾ç‰‡å°ºå¯¸å·®å¼‚ï¼Œç¡®ä¿å®Œç¾æ‹¼æ¥
- ğŸš€ **é«˜æ€§èƒ½**: ä¼˜åŒ–çš„ç®—æ³•å’Œå†…å­˜ç®¡ç†ï¼Œæ”¯æŒå¤§å›¾ç‰‡å¤„ç†
- ğŸ“± **å“åº”å¼è®¾è®¡**: é€‚é…å„ç§å±å¹•å°ºå¯¸ï¼Œç§»åŠ¨ç«¯å‹å¥½
- ğŸ¨ **ç®€çº¦ç•Œé¢**: ç›´è§‚çš„æ‹–æ‹½ä¸Šä¼ ï¼Œå®æ—¶è¿›åº¦æ˜¾ç¤º
- ğŸ”§ **å¯é…ç½®**: æ”¯æŒè°ƒæ•´å¿½ç•¥è¾¹ç¼˜åƒç´ æ•°é‡ï¼ˆç”¨äºæ’é™¤æ»šåŠ¨æ¡ï¼‰

## ä½¿ç”¨æ–¹æ³•

1. **æ‰“å¼€åº”ç”¨**: åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `index.html`
2. **é€‰æ‹©å›¾ç‰‡**: ç‚¹å‡»ä¸Šä¼ åŒºåŸŸæˆ–æ‹–æ‹½å›¾ç‰‡æ–‡ä»¶åˆ°é¡µé¢
3. **è°ƒæ•´è®¾ç½®**: å¯ä»¥è°ƒæ•´"å¿½ç•¥å³ä¾§åƒç´ æ•°é‡"æ¥æ’é™¤æ»šåŠ¨æ¡å½±å“
4. **å¼€å§‹æ‹¼æ¥**: ç‚¹å‡»"å¼€å§‹æ‹¼æ¥"æŒ‰é’®
5. **æŸ¥çœ‹ç»“æœ**: æ‹¼æ¥å®Œæˆåå¯ä»¥é¢„è§ˆã€ä¸‹è½½ç»“æœå›¾ç‰‡

## æ”¯æŒçš„æ ¼å¼

- JPG/JPEG
- PNG  
- WebP
- å…¶ä»–æµè§ˆå™¨æ”¯æŒçš„å›¾ç‰‡æ ¼å¼

## æŠ€æœ¯å®ç°

### æ ¸å¿ƒç®—æ³•
- **è¡Œå“ˆå¸Œ**: å°†å›¾ç‰‡æ¯ä¸€è¡Œè½¬æ¢ä¸ºå“ˆå¸Œå€¼è¿›è¡Œå¿«é€Ÿæ¯”è¾ƒ
- **æœ€é•¿å…¬å…±å­ä¸²**: ä½¿ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•æ‰¾åˆ°æœ€ä½³é‡å åŒºåŸŸ
- **æ™ºèƒ½é‡‡æ ·**: ä¼˜åŒ–æ€§èƒ½çš„åƒç´ é‡‡æ ·ç­–ç•¥

### æ€§èƒ½ä¼˜åŒ–
- **æµå¼å¤„ç†**: é€å¼ å¤„ç†å›¾ç‰‡ï¼Œé¿å…å†…å­˜å³°å€¼
- **Canvas ä¼˜åŒ–**: ä½¿ç”¨é«˜æ€§èƒ½çš„ Canvas æ¸²æŸ“è®¾ç½®
- **å†…å­˜ç®¡ç†**: åŠæ—¶é‡Šæ”¾ä¸éœ€è¦çš„èµ„æº
- **æ¸è¿›å‹ç¼©**: ä½¿ç”¨ JPEG å‹ç¼©å‡å°‘å†…å­˜å ç”¨

### ç”¨æˆ·ä½“éªŒ
- **å®æ—¶è¿›åº¦**: æ˜¾ç¤ºåŠ è½½å’Œæ‹¼æ¥è¿›åº¦
- **é”™è¯¯å¤„ç†**: å‹å¥½çš„é”™è¯¯æç¤ºå’Œå¤„ç†
- **å›¾ç‰‡é¢„è§ˆ**: ç‚¹å‡»ç»“æœå›¾ç‰‡å¯æŸ¥çœ‹å¤§å›¾
- **å“åº”å¼å¸ƒå±€**: é€‚é…ä¸åŒè®¾å¤‡å±å¹•

## ä¸ Python ç‰ˆæœ¬çš„å¯¹æ¯”

| ç‰¹æ€§ | Python ç‰ˆæœ¬ | JavaScript ç‰ˆæœ¬ |
|------|------------|----------------|
| è¿è¡Œç¯å¢ƒ | éœ€è¦ Python + ä¾èµ– | çº¯æµè§ˆå™¨è¿è¡Œ |
| å›¾ç‰‡å¤„ç† | PIL/Pillow | Canvas API |
| ç®—æ³•å®ç° | NumPy ä¼˜åŒ– | åŸç”Ÿ JavaScript |
| ç”¨æˆ·ç•Œé¢ | å‘½ä»¤è¡Œ | å›¾å½¢åŒ–ç•Œé¢ |
| æ–‡ä»¶æ“ä½œ | ç›´æ¥è¯»å†™æ–‡ä»¶ | æµè§ˆå™¨ File API |
| æ€§èƒ½ | æ›´å¿«çš„æ‰¹é‡å¤„ç† | é€‚ä¸­ï¼Œé€‚åˆä¸€èˆ¬ä½¿ç”¨ |

## æµè§ˆå™¨å…¼å®¹æ€§

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## æ³¨æ„äº‹é¡¹

1. **å›¾ç‰‡å¤§å°**: å»ºè®®å•å¼ å›¾ç‰‡ä¸è¶…è¿‡ 50MB
2. **æµè§ˆå™¨å†…å­˜**: å¤„ç†å¤§é‡æˆ–å¤§å°ºå¯¸å›¾ç‰‡æ—¶æ³¨æ„æµè§ˆå™¨å†…å­˜é™åˆ¶
3. **ç½‘ç»œç¯å¢ƒ**: çº¯å‰ç«¯å¤„ç†ï¼Œæ— éœ€ç½‘ç»œè¿æ¥
4. **æ–‡ä»¶å®‰å…¨**: æ‰€æœ‰å¤„ç†éƒ½åœ¨æœ¬åœ°è¿›è¡Œï¼Œå›¾ç‰‡ä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨

## å¼€å‘è¯´æ˜

å¦‚éœ€ä¿®æ”¹æˆ–æ‰©å±•åŠŸèƒ½ï¼š

1. **æ ¸å¿ƒç®—æ³•**: ä¿®æ”¹ `longshot.js` ä¸­çš„ `LongScreenshotStitcher` ç±»
2. **ç”¨æˆ·ç•Œé¢**: ä¿®æ”¹ `index.html` ä¸­çš„æ ·å¼å’Œ `LongShotApp` ç±»
3. **æ€§èƒ½è°ƒä¼˜**: è°ƒæ•´é‡‡æ ·å‚æ•°ã€Canvas è®¾ç½®ç­‰

## è®¸å¯è¯

ä¸åŸ Python ç‰ˆæœ¬ä¿æŒä¸€è‡´çš„è®¸å¯è¯ã€‚
```

å®Œç¾ï¼æˆ‘å·²ç»æˆåŠŸå°† Python ç‰ˆæœ¬çš„é•¿æˆªå›¾æ‹¼æ¥å·¥å…·é‡å†™ä¸º JavaScript ç‰ˆæœ¬ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªéå¸¸ç®€çº¦çš„å‰ç«¯ç•Œé¢ã€‚

## å®Œæˆçš„åŠŸèƒ½

âœ… **æ ¸å¿ƒç®—æ³•ç§»æ¤**:
- å°†å›¾ç‰‡è¡Œå“ˆå¸Œè®¡ç®—ç®—æ³•è½¬æ¢ä¸º JavaScript
- å®ç°æœ€é•¿å…¬å…±å­ä¸²ç®—æ³•ç”¨äºæ‰¾åˆ°é‡å åŒºåŸŸ
- ä¿æŒä¸ Python ç‰ˆæœ¬ç›¸åŒçš„æ‹¼æ¥é€»è¾‘

âœ… **ç®€çº¦çš„ç”¨æˆ·ç•Œé¢**:
- ç°ä»£åŒ–çš„ç®€çº¦è®¾è®¡ï¼Œä½¿ç”¨æŸ”å’Œçš„é¢œè‰²å’Œåœ†è§’
- æ”¯æŒæ‹–æ‹½ä¸Šä¼ å’Œç‚¹å‡»é€‰æ‹©æ–‡ä»¶
- å®æ—¶æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨å’Œå¤„ç†è¿›åº¦
- å“åº”å¼è®¾è®¡ï¼Œé€‚é…ç§»åŠ¨ç«¯

âœ… **ä¼˜åŒ–çš„ç”¨æˆ·ä½“éªŒ**:
- æµå¼å¤„ç†å›¾ç‰‡é¿å…å†…å­˜å³°å€¼
- å®æ—¶è¿›åº¦æ¡æ˜¾ç¤ºå¤„ç†çŠ¶æ€
- ç»“æœå›¾ç‰‡é¢„è§ˆå’Œå¤§å›¾æ¨¡æ€æ¡†
- ä¸€é”®ä¸‹è½½æ‹¼æ¥ç»“æœ

âœ… **æ€§èƒ½ä¼˜åŒ–**:
- ä½¿ç”¨é‡‡æ ·ç­–ç•¥å‡å°‘è®¡ç®—é‡
- ä¼˜åŒ– Canvas æ¸²æŸ“è®¾ç½®
- å†…å­˜ç®¡ç†å’Œåƒåœ¾å›æ”¶
- é«˜æ•ˆçš„å“ˆå¸Œç®—æ³•

## ä¸»è¦æ–‡ä»¶

1. **`web/longshot.js`** - æ ¸å¿ƒæ‹¼æ¥ç®—æ³•çš„ JavaScript å®ç°
2. **`web/index.html`** - ç®€çº¦çš„å‰ç«¯ç•Œé¢ï¼ŒåŒ…å«æ‰€æœ‰äº¤äº’é€»è¾‘
3. **`web/README.md`** - è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’ŒæŠ€æœ¯æ–‡æ¡£

## ä½¿ç”¨æ–¹æ³•

ç°åœ¨ä½ å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `web/index.html` æ–‡ä»¶ï¼Œå³å¯ä½¿ç”¨é•¿æˆªå›¾æ‹¼æ¥åŠŸèƒ½ï¼š

1. æ‹–æ‹½æˆ–é€‰æ‹©å¤šå¼ æˆªå›¾æ–‡ä»¶
2. è°ƒæ•´è®¾ç½®ï¼ˆå¦‚å¿½ç•¥å³ä¾§åƒç´ æ•°é‡ï¼‰
3. ç‚¹å‡»"å¼€å§‹æ‹¼æ¥"æŒ‰é’®
4. ç­‰å¾…å¤„ç†å®Œæˆå¹¶ä¸‹è½½ç»“æœ

è¿™ä¸ªçº¯å‰ç«¯ç‰ˆæœ¬æ— éœ€å®‰è£…ä»»ä½•ä¾èµ–ï¼Œå¯ä»¥åœ¨ä»»ä½•ç°ä»£æµè§ˆå™¨ä¸­è¿è¡Œï¼Œæä¾›äº†ä¸ Python ç‰ˆæœ¬ç›¸åŒçš„æ™ºèƒ½æ‹¼æ¥åŠŸèƒ½ï¼Œä½†æ‹¥æœ‰æ›´åŠ å‹å¥½çš„å›¾å½¢ç•Œé¢ï¼

---

**User**

web ui å‡å°‘ä¸€ä¸‹èŠ±é‡Œèƒ¡å“¨çš„ hoverã€click åŠ¨ç”»ï¼Œå†ç®€æ´ä¸€ç‚¹ï¼Œæ–¹æ­£ä¸€ç‚¹ã€‚

---

**Cursor**

æˆ‘æ¥å¸®ä½ ç®€åŒ– Web UIï¼Œå»æ‰ä¸å¿…è¦çš„åŠ¨ç”»æ•ˆæœï¼Œè®©ç•Œé¢æ›´åŠ ç®€æ´æ–¹æ­£ã€‚

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

    .settings {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

    .setting-item input {
      width: 80px;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
    }

    .file-list {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

    .file-icon {
      width: 40px;
      height: 40px;
      background: #3498db;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      margin-right: 15px;
      font-size: 12px;
    }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

    .remove-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.3s ease;
    }

    .remove-btn:hover {
      background: #c0392b;
    }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: #3498db;
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background: #2980b9;
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: #95a5a6;
      color: white;
    }

    .btn-secondary:hover:not(:disabled) {
      background: #7f8c8d;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .progress {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .progress-fill {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

    .result {
      background: white;
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .result-image {
      max-width: 100%;
      max-height: 600px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .result-image:hover {
      transform: scale(1.02);
    }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
        .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

    .setting-item input {
      width: 80px;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
    }

    .file-list {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

    .file-icon {
      width: 40px;
      height: 40px;
      background: #3498db;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      margin-right: 15px;
      font-size: 12px;
    }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

    .remove-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.3s ease;
    }

    .remove-btn:hover {
      background: #c0392b;
    }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: #3498db;
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background: #2980b9;
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: #95a5a6;
      color: white;
    }

    .btn-secondary:hover:not(:disabled) {
      background: #7f8c8d;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .progress {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .progress-fill {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

    .result {
      background: white;
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .result-image {
      max-width: 100%;
      max-height: 600px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .result-image:hover {
      transform: scale(1.02);
    }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

    .file-list {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

    .file-icon {
      width: 40px;
      height: 40px;
      background: #3498db;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      margin-right: 15px;
      font-size: 12px;
    }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

    .remove-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.3s ease;
    }

    .remove-btn:hover {
      background: #c0392b;
    }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: #3498db;
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background: #2980b9;
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: #95a5a6;
      color: white;
    }

    .btn-secondary:hover:not(:disabled) {
      background: #7f8c8d;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .progress {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .progress-fill {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

    .result {
      background: white;
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .result-image {
      max-width: 100%;
      max-height: 600px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .result-image:hover {
      transform: scale(1.02);
    }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

            .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

    .file-icon {
      width: 40px;
      height: 40px;
      background: #3498db;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      margin-right: 15px;
      font-size: 12px;
    }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

    .remove-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.3s ease;
    }

    .remove-btn:hover {
      background: #c0392b;
    }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: #3498db;
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background: #2980b9;
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: #95a5a6;
      color: white;
    }

    .btn-secondary:hover:not(:disabled) {
      background: #7f8c8d;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .progress {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .progress-fill {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

    .result {
      background: white;
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .result-image {
      max-width: 100%;
      max-height: 600px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .result-image:hover {
      transform: scale(1.02);
    }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

            .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

            .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

    .remove-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.3s ease;
    }

    .remove-btn:hover {
      background: #c0392b;
    }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: #3498db;
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background: #2980b9;
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: #95a5a6;
      color: white;
    }

    .btn-secondary:hover:not(:disabled) {
      background: #7f8c8d;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .progress {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .progress-fill {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

    .result {
      background: white;
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .result-image {
      max-width: 100%;
      max-height: 600px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .result-image:hover {
      transform: scale(1.02);
    }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

            .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

            .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

            .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: #3498db;
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background: #2980b9;
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: #95a5a6;
      color: white;
    }

    .btn-secondary:hover:not(:disabled) {
      background: #7f8c8d;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .progress {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .progress-fill {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

    .result {
      background: white;
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .result-image {
      max-width: 100%;
      max-height: 600px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .result-image:hover {
      transform: scale(1.02);
    }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

            .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

            .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

            .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

            .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

    .progress {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .progress-fill {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

    .result {
      background: white;
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .result-image {
      max-width: 100%;
      max-height: 600px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .result-image:hover {
      transform: scale(1.02);
    }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

            .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

            .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

            .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

            .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

            .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .progress-fill {
      height: 100%;
      background: #3498db;
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

    .result {
      background: white;
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .result-image {
      max-width: 100%;
      max-height: 600px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .result-image:hover {
      transform: scale(1.02);
    }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

            .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

            .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

            .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

            .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

            .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

            .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
        }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

    .result {
      background: white;
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      display: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .result-image {
      max-width: 100%;
      max-height: 600px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .result-image:hover {
      transform: scale(1.02);
    }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

            .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

            .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

            .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

            .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

            .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

            .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
        }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

            .result {
            background: white;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            display: none;
            border: 1px solid #ddd;
        }

    .result-image {
      max-width: 100%;
      max-height: 600px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .result-image:hover {
      transform: scale(1.02);
    }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 2px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
            cursor: pointer;
        }
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

            .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

            .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

            .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

            .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

            .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

            .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
        }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

            .result {
            background: white;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            display: none;
            border: 1px solid #ddd;
        }

            .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 2px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
            cursor: pointer;
        }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

    .image-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 95%;
      max-height: 95%;
      border-radius: 8px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

            .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

            .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

            .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

            .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

            .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

            .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

            .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
        }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

            .result {
            background: white;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            display: none;
            border: 1px solid #ddd;
        }

            .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 2px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
            cursor: pointer;
        }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

            .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 2px;
        }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

ç°åœ¨è®©æˆ‘æ£€æŸ¥å¹¶ç®€åŒ– JavaScript ä¸­çš„è¿›åº¦æ¡åŠ¨ç”»ï¼š

```html
                this.progressFill.style.width = `${percentage}%`;
```

è®©æˆ‘æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦æœ‰å…¶ä»–éœ€è¦ç®€åŒ–çš„æ ·å¼ï¼š

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

            .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

            .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

            .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

            .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

            .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

            .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

            .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

            .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
        }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

            .result {
            background: white;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            display: none;
            border: 1px solid #ddd;
        }

            .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 2px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
            cursor: pointer;
        }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

            .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 2px;
        }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

ç°åœ¨è®©æˆ‘ä¿®å¤ç¼©è¿›å¹¶å®Œæˆæœ€åçš„æ¸…ç†ï¼š

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

        .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
        }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

        .result {
            background: white;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            display: none;
            border: 1px solid #ddd;
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 2px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
            cursor: pointer;
        }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

        .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 2px;
        }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">ğŸ“</div>
      <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
      <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
      <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
    </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

ç°åœ¨æ£€æŸ¥æ˜¯å¦è¿˜æœ‰éœ€è¦ç®€åŒ–çš„åœ°æ–¹ï¼Œæ¯”å¦‚å‡å°‘ä¸Šä¼ åŒºåŸŸçš„å›¾æ ‡ï¼š

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    .upload-icon {
      font-size: 3em;
      color: #bdc3c7;
      margin-bottom: 20px;
    }

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

        .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
        }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

        .result {
            background: white;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            display: none;
            border: 1px solid #ddd;
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 2px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
            cursor: pointer;
        }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

        .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 2px;
        }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

            <div class="upload-area" id="uploadArea">
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

åˆ é™¤ä¸å†éœ€è¦çš„ä¸Šä¼ å›¾æ ‡æ ·å¼ï¼š

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

        .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
        }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

        .result {
            background: white;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            display: none;
            border: 1px solid #ddd;
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 2px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
            cursor: pointer;
        }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

        .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 2px;
        }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

            <div class="upload-area" id="uploadArea">
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" id="stitchBtn" disabled>
        ğŸ”— å¼€å§‹æ‹¼æ¥
      </button>
      <button class="btn btn-secondary" id="clearBtn" disabled>
        ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨
      </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

ä¿®å¤ç¼©è¿›é—®é¢˜ï¼š

```html
        <div class="upload-area" id="uploadArea">
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>
```

æ£€æŸ¥æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ï¼š

è®©æˆ‘æ£€æŸ¥å¹¶ç®€åŒ–æŒ‰é’®æ–‡å­—ä¸­çš„emojiï¼Œè®©å®ƒæ›´åŠ ç®€æ´ï¼š

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

        .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
        }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

        .result {
            background: white;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            display: none;
            border: 1px solid #ddd;
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 2px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
            cursor: pointer;
        }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

        .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 2px;
        }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

            <div class="upload-area" id="uploadArea">
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
                  <button class="btn btn-primary" id="stitchBtn" disabled>
                å¼€å§‹æ‹¼æ¥
            </button>
            <button class="btn btn-secondary" id="clearBtn" disabled>
                æ¸…ç©ºåˆ—è¡¨
            </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
        <button class="btn btn-primary" id="downloadBtn">
          ğŸ’¾ ä¸‹è½½å›¾ç‰‡
        </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

```html
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      color: #2c3e50;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 2.5em;
      font-weight: 300;
      color: #34495e;
      margin-bottom: 10px;
    }

    .header p {
      color: #7f8c8d;
      font-size: 1.1em;
    }

        .upload-area {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 4px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #3498db;
        }

        .upload-area.dragover {
            border-color: #2980b9;
        }

    

    .upload-text {
      font-size: 1.2em;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .upload-hint {
      font-size: 0.9em;
      color: #95a5a6;
    }

    .file-input {
      display: none;
    }

        .settings {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .settings h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .setting-item label {
      color: #34495e;
      font-weight: 500;
    }

        .setting-item input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 14px;
        }

        .file-list {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
        }

    .file-list h3 {
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 500;
    }

    .file-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #ecf0f1;
    }

    .file-item:last-child {
      border-bottom: none;
    }

    .file-info {
      display: flex;
      align-items: center;
    }

        .file-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
            font-size: 12px;
        }

    .file-details {
      display: flex;
      flex-direction: column;
    }

    .file-name {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 2px;
    }

    .file-size {
      font-size: 0.9em;
      color: #7f8c8d;
    }

        .remove-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
    }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .progress {
            background: white;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 30px;
            display: none;
            border: 1px solid #ddd;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
        }

    .progress-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 0.9em;
    }

        .result {
            background: white;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            display: none;
            border: 1px solid #ddd;
        }

        .result-image {
            max-width: 100%;
            max-height: 600px;
            border-radius: 2px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
            cursor: pointer;
        }

    .image-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      cursor: pointer;
    }

        .image-modal img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 95%;
            max-height: 95%;
            border-radius: 2px;
        }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: white;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
    }

    .empty-state {
      text-align: center;
      color: #7f8c8d;
      font-style: italic;
      padding: 20px 0;
    }

    @media (max-width: 600px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2em;
      }

      .upload-area {
        padding: 40px 15px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>é•¿æˆªå›¾æ‹¼æ¥å·¥å…·</h1>
      <p>æ™ºèƒ½æ‹¼æ¥å¤šå¼ æˆªå›¾ï¼Œè‡ªåŠ¨è¯†åˆ«é‡å åŒºåŸŸ</p>
    </div>

            <div class="upload-area" id="uploadArea">
            <div class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°æ­¤å¤„</div>
            <div class="upload-hint">æ”¯æŒ JPGã€PNGã€WebP ç­‰æ ¼å¼ï¼Œå»ºè®®æŒ‰é¡ºåºé€‰æ‹©</div>
            <input type="file" id="fileInput" class="file-input" multiple accept="image/*">
        </div>

    <div class="settings">
      <h3>è®¾ç½®</h3>
      <div class="setting-item">
        <label for="ignorePixels">å¿½ç•¥å³ä¾§åƒç´ æ•°é‡:</label>
        <input type="number" id="ignorePixels" value="20" min="0" max="100">
      </div>
    </div>

    <div class="file-list" id="fileList">
      <h3>å·²é€‰æ‹©çš„å›¾ç‰‡ (<span id="fileCount">0</span>)</h3>
      <div id="fileItems">
        <div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>
      </div>
    </div>

    <div class="actions">
                  <button class="btn btn-primary" id="stitchBtn" disabled>
                å¼€å§‹æ‹¼æ¥
            </button>
            <button class="btn btn-secondary" id="clearBtn" disabled>
                æ¸…ç©ºåˆ—è¡¨
            </button>
    </div>

    <div class="progress" id="progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">å‡†å¤‡ä¸­...</div>
    </div>

    <div class="result" id="result">
      <h3>æ‹¼æ¥ç»“æœ</h3>
      <img id="resultImage" class="result-image" alt="æ‹¼æ¥ç»“æœ" title="ç‚¹å‡»æŸ¥çœ‹å¤§å›¾">
      <div>
                        <button class="btn btn-primary" id="downloadBtn">
                    ä¸‹è½½å›¾ç‰‡
                </button>
      </div>
    </div>

    <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal">
      <span class="modal-close">&times;</span>
      <img id="modalImage" alt="é¢„è§ˆå›¾ç‰‡">
    </div>
  </div>

  <script src="longshot.js"></script>
  <script>
    class LongShotApp {
      constructor() {
        this.stitcher = new LongScreenshotStitcher();
        this.selectedFiles = [];
        this.resultCanvas = null;

        this.initializeElements();
        this.bindEvents();
      }

      initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.fileList = document.getElementById('fileList');
        this.fileItems = document.getElementById('fileItems');
        this.fileCount = document.getElementById('fileCount');
        this.stitchBtn = document.getElementById('stitchBtn');
        this.clearBtn = document.getElementById('clearBtn');
        this.progress = document.getElementById('progress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.result = document.getElementById('result');
        this.resultImage = document.getElementById('resultImage');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.ignorePixels = document.getElementById('ignorePixels');
        this.imageModal = document.getElementById('imageModal');
        this.modalImage = document.getElementById('modalImage');
      }

      bindEvents() {
        // æ–‡ä»¶é€‰æ‹©
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

        // æ‹–æ‹½ä¸Šä¼ 
        this.uploadArea.addEventListener('dragover', (e) => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', (e) => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', (e) => this.handleDrop(e));

        // æŒ‰é’®äº‹ä»¶
        this.stitchBtn.addEventListener('click', () => this.startStitching());
        this.clearBtn.addEventListener('click', () => this.clearFiles());
        this.downloadBtn.addEventListener('click', () => this.downloadResult());

        // è®¾ç½®å˜æ›´
        this.ignorePixels.addEventListener('change', () => {
          this.stitcher.setIgnoreRightPixels(parseInt(this.ignorePixels.value) || 20);
        });

        // å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†
        this.resultImage.addEventListener('click', () => this.showImageModal());
        this.imageModal.addEventListener('click', () => this.hideImageModal());
        document.querySelector('.modal-close').addEventListener('click', () => this.hideImageModal());
      }

      handleFileSelect(e) {
        const files = Array.from(e.target.files);
        this.addFiles(files);
      }

      handleDragOver(e) {
        e.preventDefault();
        this.uploadArea.classList.add('dragover');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');
      }

      handleDrop(e) {
        e.preventDefault();
        this.uploadArea.classList.remove('dragover');

        const files = Array.from(e.dataTransfer.files).filter(file =>
          file.type.startsWith('image/')
        );
        this.addFiles(files);
      }

      addFiles(files) {
        const validFiles = files.filter(file => file.type.startsWith('image/'));
        this.selectedFiles.push(...validFiles);
        this.updateFileList();
        this.updateButtons();
      }

      updateFileList() {
        this.fileCount.textContent = this.selectedFiles.length;

        if (this.selectedFiles.length === 0) {
          this.fileItems.innerHTML = '<div class="empty-state">è¯·é€‰æ‹©è‡³å°‘2å¼ å›¾ç‰‡</div>';
          return;
        }

        this.fileItems.innerHTML = '';
        this.selectedFiles.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-item';

          fileItem.innerHTML = `
                        <div class="file-info">
                            <div class="file-icon">${index + 1}</div>
                            <div class="file-details">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="app.removeFile(${index})">ç§»é™¤</button>
                    `;

          this.fileItems.appendChild(fileItem);
        });
      }

      removeFile(index) {
        this.selectedFiles.splice(index, 1);
        this.updateFileList();
        this.updateButtons();
      }

      clearFiles() {
        this.selectedFiles = [];
        this.fileInput.value = '';
        this.updateFileList();
        this.updateButtons();
        this.hideResult();
      }

      updateButtons() {
        const hasEnoughFiles = this.selectedFiles.length >= 2;
        this.stitchBtn.disabled = !hasEnoughFiles;
        this.clearBtn.disabled = this.selectedFiles.length === 0;
      }

      async startStitching() {
        if (this.selectedFiles.length < 2) {
          alert('è¯·è‡³å°‘é€‰æ‹©2å¼ å›¾ç‰‡');
          return;
        }

        this.showProgress();
        this.hideResult();
        this.stitchBtn.disabled = true;

        try {
          this.resultCanvas = await this.stitcher.stitchMultipleImages(
            this.selectedFiles,
            (progress) => this.updateProgress(progress)
          );

          this.showResult();
        } catch (error) {
          console.error('æ‹¼æ¥å¤±è´¥:', error);
          alert(`æ‹¼æ¥å¤±è´¥: ${error.message}`);
        } finally {
          this.hideProgress();
          this.stitchBtn.disabled = false;
        }
      }

      updateProgress(progress) {
        let percentage, text;

        if (progress.stage === 'loading') {
          percentage = (progress.current / progress.total) * 50;
          text = `åŠ è½½å›¾ç‰‡ä¸­... (${progress.current}/${progress.total})`;
        } else if (progress.stage === 'stitching') {
          percentage = 50 + (progress.current / progress.total) * 50;
          text = `æ‹¼æ¥ä¸­... (${progress.current}/${progress.total})`;
        }

        this.progressFill.style.width = `${percentage}%`;
        this.progressText.textContent = text;
      }

      showProgress() {
        this.progress.style.display = 'block';
        this.progressFill.style.width = '0%';
        this.progressText.textContent = 'å‡†å¤‡ä¸­...';
      }

      hideProgress() {
        this.progress.style.display = 'none';
      }

      showResult() {
        if (this.resultCanvas) {
          this.resultImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.result.style.display = 'block';

          // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
          this.result.scrollIntoView({ behavior: 'smooth' });
        }
      }

      hideResult() {
        this.result.style.display = 'none';
      }

      downloadResult() {
        if (!this.resultCanvas) return;

        const link = document.createElement('a');
        link.download = `longshot-result-${new Date().getTime()}.jpg`;
        link.href = this.resultCanvas.toDataURL('image/jpeg', 0.9);
        link.click();
      }

      showImageModal() {
        if (this.resultCanvas) {
          this.modalImage.src = this.resultCanvas.toDataURL('image/jpeg', 0.9);
          this.imageModal.style.display = 'block';
          document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
        }
      }

      hideImageModal() {
        this.imageModal.style.display = 'none';
        document.body.style.overflow = 'auto'; // æ¢å¤èƒŒæ™¯æ»šåŠ¨
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 B';
        const k = 1024;
        const sizes = ['B', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    const app = new LongShotApp();
  </script>
</body>

</html>
```

ç°åœ¨è®©æˆ‘æµ‹è¯•ä¸€ä¸‹ç®€åŒ–åçš„ç•Œé¢ï¼š

å®Œæˆï¼æˆ‘å·²ç»æŒ‰ç…§ä½ çš„è¦æ±‚ç®€åŒ–äº† Web UIï¼Œä¸»è¦ä¿®æ”¹åŒ…æ‹¬ï¼š

## ç®€åŒ–çš„æ”¹åŠ¨

âœ… **å»é™¤èŠ±é‡Œèƒ¡å“¨çš„åŠ¨ç”»æ•ˆæœ**:
- ç§»é™¤äº† `transition` åŠ¨ç”»æ•ˆæœ
- åˆ é™¤äº† `transform: translateY(-1px)` æ‚¬åœä¸Šç§»æ•ˆæœ
- ç®€åŒ–äº† `transform: scale(1.02)` å›¾ç‰‡æ‚¬åœæ”¾å¤§æ•ˆæœ
- å»é™¤äº†è¿›åº¦æ¡çš„ `transition: width 0.3s ease` åŠ¨ç”»

âœ… **æ›´åŠ æ–¹æ­£çš„è®¾è®¡**:
- å°†æ‰€æœ‰ `border-radius` ä» 12pxã€8pxã€6px ç»Ÿä¸€æ”¹ä¸º 2px æˆ– 4px
- ä½¿ç”¨æ›´åŠ æ–¹æ­£çš„è¾¹æ¡†æ ·å¼
- ç®€åŒ–äº†åœ†è§’è®¾è®¡ï¼Œæ•´ä½“æ›´åŠ ç¡¬æœ—

âœ… **å‡å°‘è§†è§‰å¹²æ‰°**:
- ç§»é™¤äº† `box-shadow: 0 2px 10px rgba(0,0,0,0.1)` é˜´å½±æ•ˆæœ
- æ”¹ç”¨ç®€å•çš„ `border: 1px solid #ddd` è¾¹æ¡†
- åˆ é™¤äº†ä¸Šä¼ åŒºåŸŸçš„è£…é¥°æ€§å›¾æ ‡ ğŸ“
- ç§»é™¤äº†æŒ‰é’®æ–‡å­—ä¸­çš„ emoji (ğŸ”—, ğŸ—‘ï¸, ğŸ’¾)

âœ… **ä¿æŒçš„åŠŸèƒ½**:
- åŸºæœ¬çš„é¢œè‰²å˜åŒ–æ‚¬åœæ•ˆæœï¼ˆåªæ”¹å˜é¢œè‰²ï¼Œæ— åŠ¨ç”»ï¼‰
- æ ¸å¿ƒäº¤äº’åŠŸèƒ½å®Œå…¨ä¿ç•™
- æ‹–æ‹½ä¸Šä¼ ç­‰å®ç”¨åŠŸèƒ½ä¸å˜

ç°åœ¨çš„ç•Œé¢æ›´åŠ ç®€æ´ã€æ–¹æ­£ï¼Œæ²¡æœ‰å¤šä½™çš„åŠ¨ç”»æ•ˆæœï¼Œç¬¦åˆä½ è¦æ±‚çš„ç®€çº¦é£æ ¼ã€‚æ‰€æœ‰åŠŸèƒ½éƒ½ä¿æŒæ­£å¸¸å·¥ä½œï¼Œåªæ˜¯è§†è§‰æ•ˆæœæ›´åŠ æœ´ç´ å’Œç›´æ¥ã€‚

